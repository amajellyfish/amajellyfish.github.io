<!doctype html>
<html
  lang="en"
  dir="ltr"
  class="scroll-smooth"
  data-default-appearance="light"
  data-auto-appearance="false"><head><script src="/livereload.js?mindelay=10&amp;v=2&amp;port=1313&amp;path=livereload" data-no-instant defer></script>
  <meta charset="utf-8">
  
    <meta http-equiv="content-language" content="en">
  
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <meta http-equiv="X-UA-Compatible" content="ie=edge">
  <meta name="theme-color">

  
  
    <title>Ansible Inventory and Ansible.cfg &middot; </title>
    <meta name="title" content="Ansible Inventory and Ansible.cfg &middot; ">
  

  
  
    <meta name="description" content="Setting up and Ansible environment">
  
  
  
  
  <link rel="canonical" href="http://localhost:1313/tech/ansible/ansible-inventory/">
  

  
  
    <meta name="author" content="David Thomas">
  
  

  
  <meta property="og:url" content="http://localhost:1313/tech/ansible/ansible-inventory/">
  <meta property="og:title" content="Ansible Inventory and Ansible.cfg">
  <meta property="og:description" content="Setting up and Ansible environment">
  <meta property="og:locale" content="en">
  <meta property="og:type" content="article">
    <meta property="article:section" content="tech">

  
  <meta name="twitter:card" content="summary">
  <meta name="twitter:title" content="Ansible Inventory and Ansible.cfg">
  <meta name="twitter:description" content="Setting up and Ansible environment">

  
  
  
  
    
      
    
  
    
      
    
  
    
      
    
  
  
    
  

  
  
  
  
  
  

  

  
  
  
  
  
  
  
    
  
  
    
  
  
  <link
    type="text/css"
    rel="stylesheet"
    href="/css/main.bundle.min.278a55d3e0b39215730b0c642c7c22cc020054272d3850d92c957cddf6209cf18e0ed01f082db397c8c048c30e727b44ca408c350384ca92d5f37c62d008cbd8.css"
    integrity="sha512-J4pV0&#43;CzkhVzCwxkLHwizAIAVCctOFDZLJV83fYgnPGODtAfCC2zl8jASMMOcntEykCMNQOEypLV83xi0AjL2A==">

  
  
  <script
    type="text/javascript"
    src="/js/appearance.min.6f41174b3a05b680820fe08cadbfa5fb7a7ca347b76a0955cdc68b9d8aca1ce24f0547e138cea33bcc7904d551a90afcb1cc7f2d9fe8557075d501419046c08c.js"
    integrity="sha512-b0EXSzoFtoCCD&#43;CMrb&#43;l&#43;3p8o0e3aglVzcaLnYrKHOJPBUfhOM6jO8x5BNVRqQr8scx/LZ/oVXB11QFBkEbAjA=="></script>
  
  
  
  
  
  
    
    <script src="/lib/zoom/zoom.min.umd.a527109b68c082a70f3697716dd72a9d5aa8b545cf800cecbbc7399f2ca6f6e0ce3e431f2062b48bbfa47c9ea42822714060bef309be073f49b9c0e30d318d7b.js" integrity="sha512-pScQm2jAgqcPNpdxbdcqnVqotUXPgAzsu8c5nyym9uDOPkMfIGK0i7&#43;kfJ6kKCJxQGC&#43;8wm&#43;Bz9JucDjDTGNew=="></script>
  

  
  
  
    
  
  
    
  
  
    
  
  
  
  
  
  
    
    <script
      defer
      type="text/javascript"
      id="script-bundle"
      src="/js/main.bundle.min.9cc802d09f28c6af56ceee7bc6e320a39251fdae98243f2a9942f221ac57a9f49c51609699a91794a7b2580ee1deaa8e4d794a68ffa94aa317c66e893ce51e02.js"
      integrity="sha512-nMgC0J8oxq9Wzu57xuMgo5JR/a6YJD8qmULyIaxXqfScUWCWmakXlKeyWA7h3qqOTXlKaP&#43;pSqMXxm6JPOUeAg=="
      data-copy="Copy"
      data-copied="Copied"></script>
  

  
  

<script src="/lib/jquery/jquery.slim.min.b0dca576e87d7eaa5850ae4e61759c065786cdb6489d68fcc82240539eebd5da522bdb4fda085ffd245808c8fe2acb2516408eb774ef26b5f6015fc6737c0ea8.js" integrity="sha512-sNylduh9fqpYUK5OYXWcBleGzbZInWj8yCJAU57r1dpSK9tP2ghf/SRYCMj&#43;KsslFkCOt3TvJrX2AV/Gc3wOqA=="></script>


























  

  

  

  

  





  
  
    <link rel="apple-touch-icon" sizes="180x180" href="/apple-touch-icon.png">
    <link rel="icon" type="image/png" sizes="32x32" href="/favicon-32x32.png">
    <link rel="icon" type="image/png" sizes="16x16" href="/favicon-16x16.png">
    <link rel="manifest" href="/site.webmanifest">
  

  
  <script type="application/ld+json">
  [{
    "@context": "https://schema.org",
    "@type": "Article",
    "articleSection": "",
    "name": "Ansible Inventory and Ansible.cfg",
    "headline": "Ansible Inventory and Ansible.cfg",
    "description": "Setting up and Ansible environment",
    "abstract": "\u003ch2 class=\u0022relative group\u0022\u003eAnsible projects\n    \u003cdiv id=\u0022ansible-projects\u0022 class=\u0022anchor\u0022\u003e\u003c\/div\u003e\n    \n    \u003cspan\n        class=\u0022absolute top-0 w-6 transition-opacity opacity-0 -start-6 not-prose group-hover:opacity-100 select-none\u0022\u003e\n        \u003ca class=\u0022text-primary-300 dark:text-neutral-700 !no-underline\u0022 href=\u0022#ansible-projects\u0022 aria-label=\u0022Anchor\u0022\u003e#\u003c\/a\u003e\n    \u003c\/span\u003e\n    \n\u003c\/h2\u003e\n\u003cp\u003eFor small companies, you can use a single Ansible configuration. But for larger ones, it\u0026rsquo;s a good idea to use different project directories. A project directory contains everything you need to work on a single project. Including:\u003c\/p\u003e",
    "inLanguage": "en",
    "url" : "http://localhost:1313/tech/ansible/ansible-inventory/",
    "author" : {
      "@type": "Person",
      "name": "David Thomas"
    },
    
    
    
    
    
    
    
    
    "mainEntityOfPage": "true",
    "wordCount": "1604"
  }]
  </script>



  
  

  
  

  
  

  
  
    
      <script src="https://www.gstatic.com/firebasejs/8.10.0/firebase-app.js"></script>
      <script src="https://www.gstatic.com/firebasejs/8.10.0/firebase-firestore.js"></script>
      <script src="https://www.gstatic.com/firebasejs/8.10.0/firebase-auth.js"></script>
      <script>

    const firebaseConfig = {
      apiKey: "AIzaSyApsKLCbGb5fkkrzxABOtl3-OUuBcRPVsc",
      authDomain: "davidwrites-89dd7.firebaseapp.com",
      projectId: "davidwrites-89dd7",
      storageBucket: "davidwrites-89dd7.firebasestorage.app",
      messagingSenderId: "433139099634",
      appId: "1:433139099634:web:c14275555bd7171e6c6d6b",
      measurementId: "G-XX5507B82W"
    };

        var app = firebase.initializeApp(firebaseConfig);
        var db = firebase.firestore();
        var auth = firebase.auth();

      </script>
    
  

  
  
</head>







  
    
  







  
    
  






  
  
  <body class="flex flex-col h-screen m-auto leading-7 max-w-7xl px-6 sm:px-14 md:px-24 lg:px-32 text-lg bg-neutral text-neutral-900 dark:bg-neutral-800 dark:text-neutral scrollbar-thin scrollbar-track-neutral-200 scrollbar-thumb-neutral-400 dark:scrollbar-track-neutral-800 dark:scrollbar-thumb-neutral-600">
    <div id="the-top" class="absolute flex self-center">
      <a
        class="px-3 py-1 text-sm -translate-y-8 rounded-b-lg bg-primary-200 focus:translate-y-0 dark:bg-neutral-600"
        href="#main-content">
        <span class="font-bold text-primary-600 pe-2 dark:text-primary-400">&darr;</span>
        Skip to main content
      </a>
    </div>
    
    
      













<div
  class="main-menu flex items-center justify-between py-6 md:justify-start gap-x-3 pt-[2px] pr-2 md:pr-4 pb-[3px] pl-0">
  
  
    
    
      <div>
        <a href="/" class="flex">
          <span class="sr-only"></span>
          
            <img
              src="/img/logo.png"
              width="200"
              height="37"
              class="logo max-h-[5rem] max-w-[5rem] object-scale-down object-left nozoom"
              alt="">
          
        </a>
      </div>
    

  <div class="flex flex-1 items-center justify-between">
    <nav class="flex space-x-3">
      
    </nav>
    
  <nav class="hidden md:flex items-center gap-x-5 md:ml-12 h-12">
    
      
        
  <a
  href="/tech/"
  
  class="flex items-center hover:text-primary-600 dark:hover:text-primary-400"
  aria-label="Tech"
  title="">
  
  
    <p class="text-base font-medium">
      Tech
    </p>
  
</a>



      
        
  <a
  href="/notes/"
  
  class="flex items-center hover:text-primary-600 dark:hover:text-primary-400"
  aria-label="Notes"
  title="Book Notes &amp; Reviews">
  
  
    <p class="text-base font-medium">
      Notes
    </p>
  
</a>



      
        
  <a
  href="/articles/"
  
  class="flex items-center hover:text-primary-600 dark:hover:text-primary-400"
  aria-label="Articles"
  title="Articles">
  
  
    <p class="text-base font-medium">
      Articles
    </p>
  
</a>



      
        
  <a
  href="/now/"
  
  class="flex items-center hover:text-primary-600 dark:hover:text-primary-400"
  aria-label="Now"
  title="Now">
  
  
    <p class="text-base font-medium">
      Now
    </p>
  
</a>



      
        
  <a
  href=""
  
  class="flex items-center hover:text-primary-600 dark:hover:text-primary-400"
  
  title="">
  
  
</a>



      
    

    

    

    
      <button
        id="search-button"
        aria-label="Search"
        class="text-base hover:text-primary-600 dark:hover:text-primary-400"
        title="Search (/)">
        <span class="relative block icon"><svg aria-hidden="true" focusable="false" data-prefix="fas" data-icon="search" class="svg-inline--fa fa-search fa-w-16" role="img" xmlns="http://www.w3.org/2000/svg" viewBox="0 0 512 512"><path fill="currentColor" d="M505 442.7L405.3 343c-4.5-4.5-10.6-7-17-7H372c27.6-35.3 44-79.7 44-128C416 93.1 322.9 0 208 0S0 93.1 0 208s93.1 208 208 208c48.3 0 92.7-16.4 128-44v16.3c0 6.4 2.5 12.5 7 17l99.7 99.7c9.4 9.4 24.6 9.4 33.9 0l28.3-28.3c9.4-9.4 9.4-24.6.1-34zM208 336c-70.7 0-128-57.2-128-128 0-70.7 57.2-128 128-128 70.7 0 128 57.2 128 128 0 70.7-57.2 128-128 128z"/></svg>
</span>
      </button>
    

    
  </nav>

    
  <div class="flex md:hidden items-center gap-x-5 md:ml-12 h-12">
    <span></span>

    

    

    
      <button
        id="search-button-mobile"
        aria-label="Search"
        class="text-base hover:text-primary-600 dark:hover:text-primary-400"
        title="Search (/)">
        <span class="relative block icon"><svg aria-hidden="true" focusable="false" data-prefix="fas" data-icon="search" class="svg-inline--fa fa-search fa-w-16" role="img" xmlns="http://www.w3.org/2000/svg" viewBox="0 0 512 512"><path fill="currentColor" d="M505 442.7L405.3 343c-4.5-4.5-10.6-7-17-7H372c27.6-35.3 44-79.7 44-128C416 93.1 322.9 0 208 0S0 93.1 0 208s93.1 208 208 208c48.3 0 92.7-16.4 128-44v16.3c0 6.4 2.5 12.5 7 17l99.7 99.7c9.4 9.4 24.6 9.4 33.9 0l28.3-28.3c9.4-9.4 9.4-24.6.1-34zM208 336c-70.7 0-128-57.2-128-128 0-70.7 57.2-128 128-128 70.7 0 128 57.2 128 128 0 70.7-57.2 128-128 128z"/></svg>
</span>
      </button>
    

    
  </div>

  </div>
  
  <div class="-my-2 md:hidden">
    <div id="menu-button" class="block">
      
        <div class="cursor-pointer hover:text-primary-600 dark:hover:text-primary-400">
          <span class="relative block icon"><svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 448 512"><path fill="currentColor" d="M0 96C0 78.33 14.33 64 32 64H416C433.7 64 448 78.33 448 96C448 113.7 433.7 128 416 128H32C14.33 128 0 113.7 0 96zM0 256C0 238.3 14.33 224 32 224H416C433.7 224 448 238.3 448 256C448 273.7 433.7 288 416 288H32C14.33 288 0 273.7 0 256zM416 448H32C14.33 448 0 433.7 0 416C0 398.3 14.33 384 32 384H416C433.7 384 448 398.3 448 416C448 433.7 433.7 448 416 448z"/></svg>
</span>
        </div>
        <div
          id="menu-wrapper"
          class="fixed inset-0 z-30 invisible w-screen h-screen m-0 overflow-auto transition-opacity opacity-0 cursor-default bg-neutral-100/50 backdrop-blur-sm dark:bg-neutral-900/50 pt-[5px]">
          <ul
            class="flex space-y-2 mt-3 flex-col items-end w-full px-6 py-6 mx-auto overflow-visible list-none text-end max-w-7xl">
            <li id="menu-close-button">
              <span
                class="cursor-pointer inline-block align-text-bottom hover:text-primary-600 dark:hover:text-primary-400">
                <span class="relative block icon"><svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 320 512"><path fill="currentColor" d="M310.6 361.4c12.5 12.5 12.5 32.75 0 45.25C304.4 412.9 296.2 416 288 416s-16.38-3.125-22.62-9.375L160 301.3L54.63 406.6C48.38 412.9 40.19 416 32 416S15.63 412.9 9.375 406.6c-12.5-12.5-12.5-32.75 0-45.25l105.4-105.4L9.375 150.6c-12.5-12.5-12.5-32.75 0-45.25s32.75-12.5 45.25 0L160 210.8l105.4-105.4c12.5-12.5 32.75-12.5 45.25 0s12.5 32.75 0 45.25l-105.4 105.4L310.6 361.4z"/></svg>
</span>
              </span>
            </li>

            
              
  <li class="mt-1">
  <a
    href="/tech/"
    
    class="flex items-center hover:text-primary-600 dark:hover:text-primary-400"
    aria-label="Tech"
    title="">
    
    
      <p class="text-bg font-bg">
        Tech
      </p>
    
  </a>
</li>



            
              
  <li class="mt-1">
  <a
    href="/notes/"
    
    class="flex items-center hover:text-primary-600 dark:hover:text-primary-400"
    aria-label="Notes"
    title="Book Notes &amp; Reviews">
    
    
      <p class="text-bg font-bg">
        Notes
      </p>
    
  </a>
</li>



            
              
  <li class="mt-1">
  <a
    href="/articles/"
    
    class="flex items-center hover:text-primary-600 dark:hover:text-primary-400"
    aria-label="Articles"
    title="Articles">
    
    
      <p class="text-bg font-bg">
        Articles
      </p>
    
  </a>
</li>



            
              
  <li class="mt-1">
  <a
    href="/now/"
    
    class="flex items-center hover:text-primary-600 dark:hover:text-primary-400"
    aria-label="Now"
    title="Now">
    
    
      <p class="text-bg font-bg">
        Now
      </p>
    
  </a>
</li>



            
              
  <li class="mt-1">
  <a
    href=""
    
    class="flex items-center hover:text-primary-600 dark:hover:text-primary-400"
    
    title="">
    
    
  </a>
</li>



            

          </ul>
          
        </div>
      
    </div>
  </div>

</div>




  <script>
    (function () {
      var $mainmenu = $(".main-menu");
      var path = window.location.pathname;
      $mainmenu.find('a[href="' + path + '"]').each(function (i, e) {
        $(e).children("p").addClass("active");
      });
    })();
  </script>


    
    <div class="relative flex flex-col grow">
      <main id="main-content" class="grow">
        
  
  <article>
    
    

    
    <header id="single_header" class="mt-5 max-w-prose">
      
      <h1 class="mt-0 text-4xl font-extrabold text-neutral-900 dark:text-neutral">
        Ansible Inventory and Ansible.cfg
      </h1>
      <div class="mt-1 mb-6 text-base text-neutral-500 dark:text-neutral-400 print:hidden">
        





  
  



  

  
  
  
    
  

  

  

  

  

  

  

  

  

  

  


  <div class="flex flex-row flex-wrap items-center">
    
    

    
    
  </div>

  

  
  

  
  



      </div>
      
        
  
  
  
  
  
  

  

  

  

  

      
    </header>

    
    <section class="flex flex-col max-w-full mt-0 prose dark:prose-invert lg:flex-row">
      
      
      
      
      
        <div class="order-first lg:ml-auto px-0 lg:order-last lg:ps-8 lg:max-w-2xs">
          <div class="toc ps-5 print:hidden lg:sticky lg:top-10">
            
              <details
  open
  id="TOCView"
  class="toc-right mt-0 overflow-y-auto overscroll-contain scrollbar-thin scrollbar-track-neutral-200 scrollbar-thumb-neutral-400 dark:scrollbar-track-neutral-800 dark:scrollbar-thumb-neutral-600 rounded-lg -ms-5 ps-5 pe-2 hidden lg:block">
  <summary
    class="block py-1 text-lg font-semibold cursor-pointer bg-neutral-100 text-neutral-800 -ms-5 ps-5 dark:bg-neutral-700 dark:text-neutral-100 lg:hidden">
    Table of Contents
  </summary>
  <div
    class="min-w-[220px] py-2 border-dotted border-s-1 -ms-5 ps-5 dark:border-neutral-600">
    <nav id="TableOfContents">
  <ul>
    <li><a href="#ansible-projects">Ansible projects</a></li>
    <li><a href="#inventory">Inventory</a>
      <ul>
        <li><a href="#listing-hosts">Listing hosts</a></li>
        <li><a href="#listing-groups">Listing groups</a></li>
        <li><a href="#host-variables">Host variables</a></li>
        <li><a href="#multiple-inventory-files">Multiple inventory files</a>
          <ul>
            <li><a href="#working-with-multiple-inventory-files">Working with Multiple Inventory Files</a></li>
          </ul>
        </li>
        <li><a href="#lab-using-multiple-inventories">Lab: Using Multiple Inventories</a></li>
        <li><a href="#inventory-commands">Inventory commands:</a>
          <ul>
            <li><a href="#using-the-ansible-inventory-command">Using the ansible-inventory Command</a></li>
          </ul>
        </li>
      </ul>
    </li>
  </ul>

  <ul>
    <li>
      <ul>
        <li>
          <ul>
            <li><a href="#configuring-dynamic-inventory">Configuring Dynamic Inventory</a></li>
          </ul>
        </li>
      </ul>
    </li>
  </ul>
</nav>
  </div>
</details>
<details class="toc-inside mt-0 overflow-hidden rounded-lg -ms-5 ps-5 lg:hidden">
  <summary
    class="py-1 text-lg font-semibold cursor-pointer bg-neutral-100 text-neutral-800 -ms-5 ps-5 dark:bg-neutral-700 dark:text-neutral-100 lg:hidden">
    Table of Contents
  </summary>
  <div
    class="py-2 border-dotted border-neutral-300 border-s-1 -ms-5 ps-5 dark:border-neutral-600">
    <nav id="TableOfContents">
  <ul>
    <li><a href="#ansible-projects">Ansible projects</a></li>
    <li><a href="#inventory">Inventory</a>
      <ul>
        <li><a href="#listing-hosts">Listing hosts</a></li>
        <li><a href="#listing-groups">Listing groups</a></li>
        <li><a href="#host-variables">Host variables</a></li>
        <li><a href="#multiple-inventory-files">Multiple inventory files</a>
          <ul>
            <li><a href="#working-with-multiple-inventory-files">Working with Multiple Inventory Files</a></li>
          </ul>
        </li>
        <li><a href="#lab-using-multiple-inventories">Lab: Using Multiple Inventories</a></li>
        <li><a href="#inventory-commands">Inventory commands:</a>
          <ul>
            <li><a href="#using-the-ansible-inventory-command">Using the ansible-inventory Command</a></li>
          </ul>
        </li>
      </ul>
    </li>
  </ul>

  <ul>
    <li>
      <ul>
        <li>
          <ul>
            <li><a href="#configuring-dynamic-inventory">Configuring Dynamic Inventory</a></li>
          </ul>
        </li>
      </ul>
    </li>
  </ul>
</nav>
  </div>
</details>


<script>
  (function () {
    'use strict'

    const SCROLL_OFFSET_RATIO = 0.33
    const TOC_SELECTOR = '#TableOfContents'
    const ANCHOR_SELECTOR = '.anchor'
    const TOC_LINK_SELECTOR = 'a[href^="#"]'
    const NESTED_LIST_SELECTOR = 'li ul'
    const ACTIVE_CLASS = 'active'
    let isJumpingToAnchor = false

    function getActiveAnchorId(anchors, offsetRatio) {
      const threshold = window.scrollY + window.innerHeight * offsetRatio
      const tocLinks = [...document.querySelectorAll('#TableOfContents a[href^="#"]')]
      const tocIds = new Set(tocLinks.map(link => link.getAttribute('href').substring(1)))

      if (isJumpingToAnchor) {
        for (let i = 0; i < anchors.length; i++) {
          const anchor = anchors[i]
          if (!tocIds.has(anchor.id)) continue
          const top = anchor.getBoundingClientRect().top + window.scrollY
          if (Math.abs(window.scrollY - top) < 100) {
            return anchor.id
          }
        }
      }

      for (let i = anchors.length - 1; i >= 0; i--) {
        const top = anchors[i].getBoundingClientRect().top + window.scrollY
        if (top <= threshold && tocIds.has(anchors[i].id)) {
          return anchors[i].id
        }
      }
      return anchors.find(anchor => tocIds.has(anchor.id))?.id || ''
    }

    function updateTOC({ toc, anchors, links, scrollOffset, collapseInactive }) {
      const activeId = getActiveAnchorId(anchors, scrollOffset)
      if (!activeId) return

      links.forEach(link => {
        const isActive = link.getAttribute('href') === `#${activeId}`
        link.classList.toggle(ACTIVE_CLASS, isActive)

        if (collapseInactive) {
          const ul = link.closest('li')?.querySelector('ul')
          if (ul) ul.style.display = isActive ? '' : 'none'
        }
      })

      if (collapseInactive) {
        const activeLink = toc.querySelector(`a[href="#${CSS.escape(activeId)}"]`)
        let el = activeLink
        while (el && el !== toc) {
          if (el.tagName === 'UL') el.style.display = ''
          if (el.tagName === 'LI') el.querySelector('ul')?.style.setProperty('display', '')
          el = el.parentElement
        }
      }
    }

    function initTOC() {
      const toc = document.querySelector(TOC_SELECTOR)
      if (!toc) return

      const collapseInactive = true
      const anchors = [...document.querySelectorAll(ANCHOR_SELECTOR)]
      const links = [...toc.querySelectorAll(TOC_LINK_SELECTOR)]

      if (collapseInactive) {
        toc.querySelectorAll(NESTED_LIST_SELECTOR).forEach(ul => ul.style.display = 'none')
      }

      links.forEach(link => {
        link.addEventListener('click', () => {
          isJumpingToAnchor = true
        })
      })

      const config = {
        toc,
        anchors,
        links,
        scrollOffset: SCROLL_OFFSET_RATIO,
        collapseInactive
      }

      window.addEventListener('scroll', () => updateTOC(config), { passive: true })
      window.addEventListener('hashchange', () => updateTOC(config), { passive: true })

      updateTOC(config)
    }

    document.readyState === 'loading'
      ? document.addEventListener('DOMContentLoaded', initTOC)
      : initTOC()
  })()
</script>


            
          </div>
        </div>
      


      <div class="min-w-0 min-h-0 max-w-fit">
        

        <div class="article-content max-w-prose mb-20">
          
<h2 class="relative group">Ansible projects
    <div id="ansible-projects" class="anchor"></div>
    
    <span
        class="absolute top-0 w-6 transition-opacity opacity-0 -start-6 not-prose group-hover:opacity-100 select-none">
        <a class="text-primary-300 dark:text-neutral-700 !no-underline" href="#ansible-projects" aria-label="Anchor">#</a>
    </span>
    
</h2>
<p>For small companies, you can use a single Ansible configuration. But for larger ones, it&rsquo;s a good idea to use different project directories. A project directory contains everything you need to work on a single project. Including:</p>
<ul>
<li>playbooks</li>
<li>variable files</li>
<li>task files</li>
<li>inventory files</li>
<li>ansible.cfg</li>
</ul>
<p><em>playbook</em>
An Ansible script written in YAML that enforce the desired configuration on manage hosts.</p>

<h2 class="relative group">Inventory
    <div id="inventory" class="anchor"></div>
    
    <span
        class="absolute top-0 w-6 transition-opacity opacity-0 -start-6 not-prose group-hover:opacity-100 select-none">
        <a class="text-primary-300 dark:text-neutral-700 !no-underline" href="#inventory" aria-label="Anchor">#</a>
    </span>
    
</h2>
<p>A file that Identifies hosts that Ansible has to manage. You can also use this to list and group hosts and specify host variables. Each project should have it&rsquo;s own inventory file.</p>
<p>/etc/ansible/hosts</p>
<ul>
<li>can be used for system wide inventory.</li>
<li>default if no inventory file is specified.</li>
<li>has some basic inventory formatting info if you forget)</li>
<li>Ansible will also target localhosts if no hosts are found in the inventory file.</li>
<li>It&rsquo;s a good idea to store inventory files in large environments in their own project folders.</li>
</ul>
<p>localhost is not defined in inventory. It is an implicit host that is usable and refers to the Ansible control machine. Using localhost can be a good way to verify the accessibility of services on managed hosts.</p>

<h3 class="relative group">Listing hosts
    <div id="listing-hosts" class="anchor"></div>
    
    <span
        class="absolute top-0 w-6 transition-opacity opacity-0 -start-6 not-prose group-hover:opacity-100 select-none">
        <a class="text-primary-300 dark:text-neutral-700 !no-underline" href="#listing-hosts" aria-label="Anchor">#</a>
    </span>
    
</h3>
<p>List hosts by IP address or hostname. You can list a range of hosts in an inventory file as well such as <code>web-server[1:10].example.com</code></p>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-yaml" data-lang="yaml"><span class="line"><span class="cl"><span class="l">ansible1:2222 &lt; specify ssh port if the host is not using the default port 22</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="l">ansible2</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="m">10.0.10.55</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="l">web-server[1:10].example.com</span><span class="w">
</span></span></span></code></pre></div>
<h3 class="relative group">Listing groups
    <div id="listing-groups" class="anchor"></div>
    
    <span
        class="absolute top-0 w-6 transition-opacity opacity-0 -start-6 not-prose group-hover:opacity-100 select-none">
        <a class="text-primary-300 dark:text-neutral-700 !no-underline" href="#listing-groups" aria-label="Anchor">#</a>
    </span>
    
</h3>
<p>You can list groups and groups of groups. See the groups web and db are included in the group &ldquo;servers:children&rdquo;</p>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-yaml" data-lang="yaml"><span class="line"><span class="cl"><span class="l">ansible1</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="l">ansible2</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="m">10.0.10.55</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="l">web-server[1:10].example.com</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="p">[</span><span class="l">web]</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="l">web-server[1:10].example.com</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="p">[</span><span class="l">db]</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="l">db1</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="l">db2</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="p">[</span><span class="l">servers:children] &lt;-- servers is the group of groups and children is the parameter that specifies child groups</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="l">web</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="l">db</span><span class="w">
</span></span></span></code></pre></div><p>There are 3 general approaches to using groups:</p>
<p><strong>Functional groups</strong>
Address a specific group of hosts according to use. Such as web servers or database servers.</p>
<p><strong>Regional host groups</strong>
Used when working with region oriented infrastructure. Such as USA, Canada.</p>
<p><strong>Staging host groups</strong>
Used to address different hosts according to the staging phase that the current environment is in. Such as testing, development, production.</p>
<p>Undefined host groups are called implicit host groups. These are <strong>all</strong>, <strong>ungrouped</strong>, and <strong>localhost</strong>. Names making the meaning obvious.</p>

<h3 class="relative group">Host variables
    <div id="host-variables" class="anchor"></div>
    
    <span
        class="absolute top-0 w-6 transition-opacity opacity-0 -start-6 not-prose group-hover:opacity-100 select-none">
        <a class="text-primary-300 dark:text-neutral-700 !no-underline" href="#host-variables" aria-label="Anchor">#</a>
    </span>
    
</h3>
<p>In older versions of Ansible you could define variables for hosts. This is no longer used. Example:</p>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-yaml" data-lang="yaml"><span class="line"><span class="cl"><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="p">[</span><span class="l">groupname:vars]</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="l">ansible=ansible_user</span><span class="w">
</span></span></span></code></pre></div><p>Variables are now set using <strong>host_vars</strong> and <strong>group_vars</strong> directories instead.</p>

<h3 class="relative group">Multiple inventory files
    <div id="multiple-inventory-files" class="anchor"></div>
    
    <span
        class="absolute top-0 w-6 transition-opacity opacity-0 -start-6 not-prose group-hover:opacity-100 select-none">
        <a class="text-primary-300 dark:text-neutral-700 !no-underline" href="#multiple-inventory-files" aria-label="Anchor">#</a>
    </span>
    
</h3>
<p>Put all inventory files in a directory and specify the directory as the inventory to be used. For dynamic directories you also need to set the execution bit on the inventory file.</p>

<h4 class="relative group">Working with Multiple Inventory Files
    <div id="working-with-multiple-inventory-files" class="anchor"></div>
    
    <span
        class="absolute top-0 w-6 transition-opacity opacity-0 -start-6 not-prose group-hover:opacity-100 select-none">
        <a class="text-primary-300 dark:text-neutral-700 !no-underline" href="#working-with-multiple-inventory-files" aria-label="Anchor">#</a>
    </span>
    
</h4>
<ul>
<li>Ansible supports working with multiple inventory files.</li>
<li>One way of using multiple inventory files is to enter multiple <code>-i</code> parameters with the <code>ansible</code> or <code>ansible-playbook</code> commands to specify the name of the files to be used.</li>
<li><code>ansible-inventory -i inventory -i listing101.py --list</code>
<ul>
<li>Would produce an output list based on the static inventory in the inventory file, as well as the dynamic inventory that is generated by the listing101.py Python script.</li>
</ul>
</li>
<li>You can also  specify the name of a directory using the <code>-i</code> option.
<ul>
<li>Uses all files in the directory as inventory files.</li>
<li>When using an inventory directory, dynamic inventory files still must be executable for this approach to work.</li>
</ul>
</li>
</ul>

<h3 class="relative group">Lab: Using Multiple Inventories
    <div id="lab-using-multiple-inventories" class="anchor"></div>
    
    <span
        class="absolute top-0 w-6 transition-opacity opacity-0 -start-6 not-prose group-hover:opacity-100 select-none">
        <a class="text-primary-300 dark:text-neutral-700 !no-underline" href="#lab-using-multiple-inventories" aria-label="Anchor">#</a>
    </span>
    
</h3>
<ul>
<li>Open a shell as the ansible user and create a directory with the name inventories.</li>
<li>Copy the file listing101.py to the directory inventories.</li>
<li>Also copy the inventory file to the directory inventories.</li>
<li>To make sure both inventories have some unique contents, add the following lines to the file inventories/inventory:</li>
</ul>
<pre tabindex="0"><code class="language-pre1" data-lang="pre1">webserver1
webserver2
</code></pre><ul>
<li>Add the following lines to the Linux /etc/hosts file:</li>
</ul>
<pre tabindex="0"><code class="language-pre1" data-lang="pre1">192.168.4.203    ansible3.example.com    ansible3
192.168.4.204    ansible4.example.com    ansible4
</code></pre><ul>
<li>Use the command <code>ansible-inventory -i inventories --list</code>.</li>
</ul>

<h3 class="relative group">Inventory commands:
    <div id="inventory-commands" class="anchor"></div>
    
    <span
        class="absolute top-0 w-6 transition-opacity opacity-0 -start-6 not-prose group-hover:opacity-100 select-none">
        <a class="text-primary-300 dark:text-neutral-700 !no-underline" href="#inventory-commands" aria-label="Anchor">#</a>
    </span>
    
</h3>
<p>To view the inventory, specify the inventory file such as ~/base/inventory in the command line. You can name the inventory file anything you want. You can also set the default in the ansible.cfg file.</p>
<p>View the current inventory:
<code>ansible -i inventory &lt;pattern&gt; --list-hosts</code></p>
<p>List inventory hosts in JSON format:
<code>ansible-inventory -i inventory --list</code></p>
<p>Display overview of hosts as a graph:
<code>ansible-inventory -i inventory --graph</code></p>
<p>In our lab example:</p>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-bash" data-lang="bash"><span class="line"><span class="cl"><span class="o">[</span>ansible@control base<span class="o">]</span>$ <span class="nb">pwd</span>
</span></span><span class="line"><span class="cl">/home/ansible/base
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="o">[</span>ansible@control base<span class="o">]</span>$ ls
</span></span><span class="line"><span class="cl">inventory
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="o">[</span>ansible@control base<span class="o">]</span>$ cat inventory
</span></span><span class="line"><span class="cl">ansible1
</span></span><span class="line"><span class="cl">ansible2
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="o">[</span>web<span class="o">]</span>
</span></span><span class="line"><span class="cl">web1
</span></span><span class="line"><span class="cl">web2
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="o">[</span>ansible@control base<span class="o">]</span>$ ansible-inventory -i inventory --graph
</span></span><span class="line"><span class="cl">@all:
</span></span><span class="line"><span class="cl">  <span class="p">|</span>--@ungrouped:
</span></span><span class="line"><span class="cl">  <span class="p">|</span>  <span class="p">|</span>--ansible1
</span></span><span class="line"><span class="cl">  <span class="p">|</span>  <span class="p">|</span>--ansible2
</span></span><span class="line"><span class="cl">  <span class="p">|</span>--@web:
</span></span><span class="line"><span class="cl">  <span class="p">|</span>  <span class="p">|</span>--web1
</span></span><span class="line"><span class="cl">  <span class="p">|</span>  <span class="p">|</span>--web2
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="o">[</span>ansible@control base<span class="o">]</span>$ ansible-inventory -i inventory --list
</span></span><span class="line"><span class="cl"><span class="o">{</span>
</span></span><span class="line"><span class="cl">    <span class="s2">&#34;_meta&#34;</span>: <span class="o">{</span>
</span></span><span class="line"><span class="cl">        <span class="s2">&#34;hostvars&#34;</span>: <span class="o">{}</span>
</span></span><span class="line"><span class="cl">    <span class="o">}</span>,
</span></span><span class="line"><span class="cl">    <span class="s2">&#34;all&#34;</span>: <span class="o">{</span>
</span></span><span class="line"><span class="cl">        <span class="s2">&#34;children&#34;</span>: <span class="o">[</span>
</span></span><span class="line"><span class="cl">            <span class="s2">&#34;ungrouped&#34;</span>,
</span></span><span class="line"><span class="cl">            <span class="s2">&#34;web&#34;</span>
</span></span><span class="line"><span class="cl">        <span class="o">]</span>
</span></span><span class="line"><span class="cl">    <span class="o">}</span>,
</span></span><span class="line"><span class="cl">    <span class="s2">&#34;ungrouped&#34;</span>: <span class="o">{</span>
</span></span><span class="line"><span class="cl">        <span class="s2">&#34;hosts&#34;</span>: <span class="o">[</span>
</span></span><span class="line"><span class="cl">            <span class="s2">&#34;ansible1&#34;</span>,
</span></span><span class="line"><span class="cl">            <span class="s2">&#34;ansible2&#34;</span>
</span></span><span class="line"><span class="cl">        <span class="o">]</span>
</span></span><span class="line"><span class="cl">    <span class="o">}</span>,
</span></span><span class="line"><span class="cl">    <span class="s2">&#34;web&#34;</span>: <span class="o">{</span>
</span></span><span class="line"><span class="cl">        <span class="s2">&#34;hosts&#34;</span>: <span class="o">[</span>
</span></span><span class="line"><span class="cl">            <span class="s2">&#34;web1&#34;</span>,
</span></span><span class="line"><span class="cl">            <span class="s2">&#34;web2&#34;</span>
</span></span><span class="line"><span class="cl">        <span class="o">]</span>
</span></span><span class="line"><span class="cl">    <span class="o">}</span>
</span></span><span class="line"><span class="cl"><span class="o">}</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="o">[</span>ansible@control base<span class="o">]</span>$ ansible -i inventory all --list-hosts
</span></span><span class="line"><span class="cl">  hosts <span class="o">(</span>4<span class="o">)</span>:
</span></span><span class="line"><span class="cl">    ansible1
</span></span><span class="line"><span class="cl">    ansible2
</span></span><span class="line"><span class="cl">    web1
</span></span><span class="line"><span class="cl">    web2
</span></span><span class="line"><span class="cl">    
</span></span><span class="line"><span class="cl"><span class="o">[</span>ansible@control base<span class="o">]</span>$ ansible -i inventory ungrouped --list-hosts
</span></span><span class="line"><span class="cl">  hosts <span class="o">(</span>2<span class="o">)</span>:
</span></span><span class="line"><span class="cl">    ansible1
</span></span><span class="line"><span class="cl">    ansible2
</span></span></code></pre></div>
<h4 class="relative group">Using the ansible-inventory Command
    <div id="using-the-ansible-inventory-command" class="anchor"></div>
    
    <span
        class="absolute top-0 w-6 transition-opacity opacity-0 -start-6 not-prose group-hover:opacity-100 select-none">
        <a class="text-primary-300 dark:text-neutral-700 !no-underline" href="#using-the-ansible-inventory-command" aria-label="Anchor">#</a>
    </span>
    
</h4>
<ul>
<li>default output of a dynamic inventory script is unformatted.</li>
<li>To show formatted JSON output of the scripts, you can use the <code>ansible-inventory</code> command.</li>
<li>Apart from the <code>--list</code> and <code>--host</code> options, this command also uses the <code>--graph</code> option to show a list of hosts, including the host groups they are a member of.</li>
</ul>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-bash" data-lang="bash"><span class="line"><span class="cl">    <span class="o">[</span>ansible@control rhce8-book<span class="o">]</span>$ ansible-inventory -i listing101.py --graph
</span></span><span class="line"><span class="cl">    <span class="o">[</span>WARNING<span class="o">]</span>: A duplicate localhost-like entry was found <span class="o">(</span>localhost<span class="o">)</span>. First found
</span></span><span class="line"><span class="cl">    localhost was 127.0.0.1
</span></span><span class="line"><span class="cl">    @all:
</span></span><span class="line"><span class="cl">      <span class="p">|</span>--@ungrouped:
</span></span><span class="line"><span class="cl">      <span class="p">|</span>  <span class="p">|</span>--127.0.0.1
</span></span><span class="line"><span class="cl">      <span class="p">|</span>  <span class="p">|</span>--192.168.4.200
</span></span><span class="line"><span class="cl">      <span class="p">|</span>  <span class="p">|</span>--192.168.4.201
</span></span><span class="line"><span class="cl">      <span class="p">|</span>  <span class="p">|</span>--192.168.4.202
</span></span><span class="line"><span class="cl">      <span class="p">|</span>  <span class="p">|</span>--ansible1
</span></span><span class="line"><span class="cl">      <span class="p">|</span>  <span class="p">|</span>--ansible1.example.com
</span></span><span class="line"><span class="cl">      <span class="p">|</span>  <span class="p">|</span>--ansible2
</span></span><span class="line"><span class="cl">      <span class="p">|</span>  <span class="p">|</span>--ansible2.example.com
</span></span><span class="line"><span class="cl">      <span class="p">|</span>  <span class="p">|</span>--control
</span></span><span class="line"><span class="cl">      <span class="p">|</span>  <span class="p">|</span>--control.example.com
</span></span><span class="line"><span class="cl">      <span class="p">|</span>  <span class="p">|</span>--localhost
</span></span><span class="line"><span class="cl">      <span class="p">|</span>  <span class="p">|</span>--localhost.localdomain
</span></span><span class="line"><span class="cl">      <span class="p">|</span>  <span class="p">|</span>--localhost4
</span></span><span class="line"><span class="cl">      <span class="p">|</span>  <span class="p">|</span>--localhost4.localdomain4
</span></span><span class="line"><span class="cl">      <span class="p">|</span>  <span class="p">|</span>--localhost6
</span></span><span class="line"><span class="cl">      <span class="p">|</span>  <span class="p">|</span>--localhost6.localdomain6
</span></span></code></pre></div>
<h1 class="relative group">Dynamic inventory
    <div id="dynamic-inventory" class="anchor"></div>
    
    <span
        class="absolute top-0 w-6 transition-opacity opacity-0 -start-6 not-prose group-hover:opacity-100 select-none">
        <a class="text-primary-300 dark:text-neutral-700 !no-underline" href="#dynamic-inventory" aria-label="Anchor">#</a>
    </span>
    
</h1>
<p>A script is used to detect inventory hosts so that you do not have to manually enter them. This is good for larger environments. You can find community provided dynamic inventory scripts that come with an .ini file that provides information on how to connect to a resource.</p>
<p>Inventory scripts must include &ndash;list and &ndash;host options and output must be JSON formatted. Here is an example from <a
  href="https://github.com/sandervanvugt/rhce8-book/blob/master/listing33.py"
    target="_blank"
  >sandervanvught</a> that generates an inventory script using /etc/hosts:</p>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-python" data-lang="python"><span class="line"><span class="cl"><span class="p">[</span><span class="n">ansible</span><span class="nd">@control</span> <span class="n">base</span><span class="p">]</span><span class="err">$</span> <span class="n">cat</span> <span class="n">inventory</span><span class="o">-</span><span class="n">helper</span><span class="o">.</span><span class="n">py</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="c1">#!/usr/bin/python</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="kn">from</span> <span class="nn">subprocess</span> <span class="kn">import</span> <span class="n">Popen</span><span class="p">,</span><span class="n">PIPE</span>
</span></span><span class="line"><span class="cl"><span class="kn">import</span> <span class="nn">sys</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="k">try</span><span class="p">:</span>
</span></span><span class="line"><span class="cl">     <span class="kn">import</span> <span class="nn">json</span>
</span></span><span class="line"><span class="cl"><span class="k">except</span> <span class="ne">ImportError</span><span class="p">:</span>
</span></span><span class="line"><span class="cl">     <span class="kn">import</span> <span class="nn">simplejson</span> <span class="k">as</span> <span class="nn">json</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="n">result</span> <span class="o">=</span> <span class="p">{}</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="n">result</span><span class="p">[</span><span class="s1">&#39;all&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="p">{}</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="n">pipe</span> <span class="o">=</span> <span class="n">Popen</span><span class="p">([</span><span class="s1">&#39;getent&#39;</span><span class="p">,</span> <span class="s1">&#39;hosts&#39;</span><span class="p">],</span> <span class="n">stdout</span><span class="o">=</span><span class="n">PIPE</span><span class="p">,</span> <span class="n">universal_newlines</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="n">result</span><span class="p">[</span><span class="s1">&#39;all&#39;</span><span class="p">][</span><span class="s1">&#39;hosts&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="p">[]</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="k">for</span> <span class="n">line</span> <span class="ow">in</span> <span class="n">pipe</span><span class="o">.</span><span class="n">stdout</span><span class="o">.</span><span class="n">readlines</span><span class="p">():</span>
</span></span><span class="line"><span class="cl">    <span class="n">s</span> <span class="o">=</span> <span class="n">line</span><span class="o">.</span><span class="n">split</span><span class="p">()</span>
</span></span><span class="line"><span class="cl">    <span class="n">result</span><span class="p">[</span><span class="s1">&#39;all&#39;</span><span class="p">][</span><span class="s1">&#39;hosts&#39;</span><span class="p">]</span><span class="o">=</span><span class="n">result</span><span class="p">[</span><span class="s1">&#39;all&#39;</span><span class="p">][</span><span class="s1">&#39;hosts&#39;</span><span class="p">]</span><span class="o">+</span><span class="n">s</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="n">result</span><span class="p">[</span><span class="s1">&#39;all&#39;</span><span class="p">][</span><span class="s1">&#39;vars&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="p">{}</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="k">if</span> <span class="nb">len</span><span class="p">(</span><span class="n">sys</span><span class="o">.</span><span class="n">argv</span><span class="p">)</span> <span class="o">==</span> <span class="mi">2</span> <span class="ow">and</span> <span class="n">sys</span><span class="o">.</span><span class="n">argv</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span> <span class="o">==</span> <span class="s1">&#39;--list&#39;</span><span class="p">:</span>
</span></span><span class="line"><span class="cl">    <span class="nb">print</span><span class="p">(</span><span class="n">json</span><span class="o">.</span><span class="n">dumps</span><span class="p">(</span><span class="n">result</span><span class="p">))</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="k">elif</span> <span class="nb">len</span><span class="p">(</span><span class="n">sys</span><span class="o">.</span><span class="n">argv</span><span class="p">)</span> <span class="o">==</span> <span class="mi">3</span> <span class="ow">and</span> <span class="n">sys</span><span class="o">.</span><span class="n">argv</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span> <span class="o">==</span> <span class="s1">&#39;--host&#39;</span><span class="p">:</span>
</span></span><span class="line"><span class="cl">    <span class="nb">print</span><span class="p">(</span><span class="n">json</span><span class="o">.</span><span class="n">dumps</span><span class="p">({}))</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="k">else</span><span class="p">:</span>
</span></span><span class="line"><span class="cl">    <span class="nb">print</span><span class="p">(</span><span class="s2">&#34;Requires an argument, please use --list or --host &lt;host&gt;&#34;</span><span class="p">)</span>
</span></span></code></pre></div><p>When ran on our sample lab:</p>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-bash" data-lang="bash"><span class="line"><span class="cl"><span class="o">[</span>ansible@control base<span class="o">]</span><span class="nv">$sudo</span> python3 ./inventory-helper.py
</span></span><span class="line"><span class="cl">Requires an argument, please use --list or --host &lt;host&gt;
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="o">[</span>ansible@control base<span class="o">]</span>$ sudo python3 ./inventory-helper.py --list
</span></span><span class="line"><span class="cl"><span class="o">{</span><span class="s2">&#34;all&#34;</span>: <span class="o">{</span><span class="s2">&#34;hosts&#34;</span>: <span class="o">[</span><span class="s2">&#34;127.0.0.1&#34;</span>, <span class="s2">&#34;localhost&#34;</span>, <span class="s2">&#34;localhost.localdomain&#34;</span>, <span class="s2">&#34;localhost4&#34;</span>, <span class="s2">&#34;localhost4.localdomain4&#34;</span>, <span class="s2">&#34;127.0.0.1&#34;</span>, <span class="s2">&#34;localhost&#34;</span>, <span class="s2">&#34;localhost.localdomain&#34;</span>, <span class="s2">&#34;localhost6&#34;</span>, <span class="s2">&#34;localhost6.localdomain6&#34;</span>, <span class="s2">&#34;192.168.124.201&#34;</span>, <span class="s2">&#34;ansible1&#34;</span>, <span class="s2">&#34;192.168.124.202&#34;</span>, <span class="s2">&#34;ansible2&#34;</span><span class="o">]</span>, <span class="s2">&#34;vars&#34;</span>: <span class="o">{}}}</span>
</span></span></code></pre></div><p>To use a dynamic inventory script:</p>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-bash" data-lang="bash"><span class="line"><span class="cl"><span class="o">[</span>ansible@control base<span class="o">]</span>$ chmod u+x inventory-helper.py 
</span></span><span class="line"><span class="cl"><span class="o">[</span>ansible@control base<span class="o">]</span>$ sudo ansible -i inventory-helper.py all --list-hosts
</span></span><span class="line"><span class="cl"><span class="o">[</span>WARNING<span class="o">]</span>: A duplicate localhost-like entry was found <span class="o">(</span>localhost<span class="o">)</span>. First found localhost was 127.0.0.1
</span></span><span class="line"><span class="cl">  hosts <span class="o">(</span>11<span class="o">)</span>:
</span></span><span class="line"><span class="cl">    127.0.0.1
</span></span><span class="line"><span class="cl">    localhost
</span></span><span class="line"><span class="cl">    localhost.localdomain
</span></span><span class="line"><span class="cl">    localhost4
</span></span><span class="line"><span class="cl">    localhost4.localdomain4
</span></span><span class="line"><span class="cl">    localhost6
</span></span><span class="line"><span class="cl">    localhost6.localdomain6
</span></span><span class="line"><span class="cl">    192.168.124.201
</span></span><span class="line"><span class="cl">    ansible1
</span></span><span class="line"><span class="cl">    192.168.124.202
</span></span><span class="line"><span class="cl">    ansible2
</span></span></code></pre></div>
<h4 class="relative group">Configuring Dynamic Inventory
    <div id="configuring-dynamic-inventory" class="anchor"></div>
    
    <span
        class="absolute top-0 w-6 transition-opacity opacity-0 -start-6 not-prose group-hover:opacity-100 select-none">
        <a class="text-primary-300 dark:text-neutral-700 !no-underline" href="#configuring-dynamic-inventory" aria-label="Anchor">#</a>
    </span>
    
</h4>
<p>dynamic inventory</p>
<ul>
<li>
<p>script that can be used to detect whether new hosts have been added to the managed environment.</p>
</li>
<li>
<p>Dynamic inventory scripts are provided by the community and exist for many different environments.</p>
</li>
<li>
<p>easy to write your own dynamic inventory script.</p>
</li>
<li>
<p>The main requirement is that the dynamic inventory script works with a <strong>--list</strong> and a <strong>--host &lt;hostname&gt;</strong> option and produces its output in JSON format.</p>
</li>
<li>
<p>Script must have the Linux execute permission set.</p>
</li>
<li>
<p>Many dynamic inventory scripts are written in Python, but this is not a requirement.</p>
</li>
<li>
<p>Writing dynamic inventory scripts is not an exam requirement</p>
</li>
</ul>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-python" data-lang="python"><span class="line"><span class="cl"><span class="ch">#!/usr/bin/python</span>
</span></span><span class="line"><span class="cl">    
</span></span><span class="line"><span class="cl"><span class="kn">from</span> <span class="nn">subprocess</span> <span class="kn">import</span> <span class="n">Popen</span><span class="p">,</span><span class="n">PIPE</span>
</span></span><span class="line"><span class="cl"><span class="kn">import</span> <span class="nn">sys</span>
</span></span><span class="line"><span class="cl">    
</span></span><span class="line"><span class="cl"><span class="k">try</span><span class="p">:</span>
</span></span><span class="line"><span class="cl">     <span class="kn">import</span> <span class="nn">json</span>
</span></span><span class="line"><span class="cl"><span class="k">except</span> <span class="ne">ImportError</span><span class="p">:</span>
</span></span><span class="line"><span class="cl">     <span class="kn">import</span> <span class="nn">simplejson</span> <span class="k">as</span> <span class="nn">json</span>
</span></span><span class="line"><span class="cl">    
</span></span><span class="line"><span class="cl"><span class="n">result</span> <span class="o">=</span> <span class="p">{}</span>
</span></span><span class="line"><span class="cl"><span class="n">result</span><span class="p">[</span><span class="s1">&#39;all&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="p">{}</span>
</span></span><span class="line"><span class="cl">    
</span></span><span class="line"><span class="cl"><span class="n">pipe</span> <span class="o">=</span> <span class="n">Popen</span><span class="p">([</span><span class="s1">&#39;getent&#39;</span><span class="p">,</span> <span class="s1">&#39;hosts&#39;</span><span class="p">],</span> <span class="n">stdout</span><span class="o">=</span><span class="n">PIPE</span><span class="p">,</span> <span class="n">universal_newlines</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
</span></span><span class="line"><span class="cl">    
</span></span><span class="line"><span class="cl"><span class="n">result</span><span class="p">[</span><span class="s1">&#39;all&#39;</span><span class="p">][</span><span class="s1">&#39;hosts&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="p">[]</span>
</span></span><span class="line"><span class="cl">    
</span></span><span class="line"><span class="cl"><span class="k">for</span> <span class="n">line</span> <span class="ow">in</span> <span class="n">pipe</span><span class="o">.</span><span class="n">stdout</span><span class="o">.</span><span class="n">readlines</span><span class="p">():</span>
</span></span><span class="line"><span class="cl">    <span class="n">s</span> <span class="o">=</span> <span class="n">line</span><span class="o">.</span><span class="n">split</span><span class="p">()</span>
</span></span><span class="line"><span class="cl">    <span class="n">result</span><span class="p">[</span><span class="s1">&#39;all&#39;</span><span class="p">][</span><span class="s1">&#39;hosts&#39;</span><span class="p">]</span><span class="o">=</span><span class="n">result</span><span class="p">[</span><span class="s1">&#39;all&#39;</span><span class="p">][</span><span class="s1">&#39;hosts&#39;</span><span class="p">]</span><span class="o">+</span><span class="n">s</span>
</span></span><span class="line"><span class="cl">    
</span></span><span class="line"><span class="cl"><span class="n">result</span><span class="p">[</span><span class="s1">&#39;all&#39;</span><span class="p">][</span><span class="s1">&#39;vars&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="p">{}</span>
</span></span><span class="line"><span class="cl">    
</span></span><span class="line"><span class="cl"><span class="k">if</span> <span class="nb">len</span><span class="p">(</span><span class="n">sys</span><span class="o">.</span><span class="n">argv</span><span class="p">)</span> <span class="o">==</span> <span class="mi">2</span> <span class="ow">and</span> <span class="n">sys</span><span class="o">.</span><span class="n">argv</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span> <span class="o">==</span> <span class="s1">&#39;--list&#39;</span><span class="p">:</span>
</span></span><span class="line"><span class="cl">    <span class="nb">print</span><span class="p">(</span><span class="n">json</span><span class="o">.</span><span class="n">dumps</span><span class="p">(</span><span class="n">result</span><span class="p">))</span>
</span></span><span class="line"><span class="cl">    
</span></span><span class="line"><span class="cl"><span class="k">elif</span> <span class="nb">len</span><span class="p">(</span><span class="n">sys</span><span class="o">.</span><span class="n">argv</span><span class="p">)</span> <span class="o">==</span> <span class="mi">3</span> <span class="ow">and</span> <span class="n">sys</span><span class="o">.</span><span class="n">argv</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span> <span class="o">==</span> <span class="s1">&#39;--host&#39;</span><span class="p">:</span>
</span></span><span class="line"><span class="cl">    <span class="nb">print</span><span class="p">(</span><span class="n">json</span><span class="o">.</span><span class="n">dumps</span><span class="p">({}))</span>
</span></span><span class="line"><span class="cl">    
</span></span><span class="line"><span class="cl"><span class="k">else</span><span class="p">:</span>
</span></span><span class="line"><span class="cl">    <span class="nb">print</span><span class="p">(</span><span class="s2">&#34;Requires an argument, please use --list or --host &lt;host&gt;&#34;</span><span class="p">)</span>
</span></span></code></pre></div><p><code>pipe = Popen(\['getent', 'hosts'\], stdout=PIPE, universal_newline=True)</code></p>
<ul>
<li>gets a list of hosts using the <code>getent</code> function.</li>
<li>This queries all hosts in /etc/hosts and other mechanisms where host name resolving is enabled.</li>
<li>To show the resulting host list, you can use the <code>\--list</code> command</li>
<li>To show details for a specific host, you can use the option <code>\--host hostname</code>.</li>
</ul>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-bash" data-lang="bash"><span class="line"><span class="cl">    <span class="o">[</span>ansible@control rhce8-book<span class="o">]</span>$ ./listing101.py --list
</span></span><span class="line"><span class="cl">    <span class="o">{</span><span class="s2">&#34;all&#34;</span>: <span class="o">{</span><span class="s2">&#34;hosts&#34;</span>: <span class="o">[</span><span class="s2">&#34;127.0.0.1&#34;</span>, <span class="s2">&#34;localhost&#34;</span>, <span class="s2">&#34;localhost.localdomain&#34;</span>, <span class="s2">&#34;localhost4&#34;</span>, <span class="s2">&#34;localhost4.localdomain4&#34;</span>, <span class="s2">&#34;127.0.0.1&#34;</span>, <span class="s2">&#34;localhost&#34;</span>, <span class="s2">&#34;localhost.localdomain&#34;</span>, <span class="s2">&#34;localhost6&#34;</span>, <span class="s2">&#34;localhost6.localdomain6&#34;</span>, <span class="s2">&#34;192.168.4.200&#34;</span>, <span class="s2">&#34;control.example.com&#34;</span>, <span class="s2">&#34;control&#34;</span>, <span class="s2">&#34;192.168.4.201&#34;</span>, <span class="s2">&#34;ansible1.example.com&#34;</span>, <span class="s2">&#34;ansible1&#34;</span>, <span class="s2">&#34;192.168.4.202&#34;</span>, <span class="s2">&#34;ansible2.example.com&#34;</span>, <span class="s2">&#34;ansible2&#34;</span><span class="o">]</span>, <span class="s2">&#34;vars&#34;</span>: <span class="o">{}}}</span>
</span></span></code></pre></div><ul>
<li>Dynamic inventory scripts are activated in the same way as regular inventory scripts: you use the <code>-i</code> option to either the <code>ansible</code> or the <code>ansible-playbook</code> command to pass the name of the inventory script as an argument.</li>
</ul>
<p>External directory service can be based on a wide range of solutions:</p>
<ul>
<li>
<p>FreeIPA</p>
</li>
<li>
<p>Active Directory</p>
</li>
<li>
<p>Red Hat Satellite</p>
</li>
<li>
<p>etc.</p>
</li>
<li>
<p>Also are available for virtual machine-based infrastructures such as VMware of Red Hat Enterprise Virtualization, where virtual machines can be discovered dynamically.</p>
</li>
<li>
<p>Can be found in cloud environments, where scripts are available for many solutions, including AWS, GCE, Azure, and OpenStack.</p>
</li>
</ul>
<p>When you are working with dynamic inventory, additional parameters are normally required:</p>
<ul>
<li>To get an inventory from an EC2 cloud environment, you need to enter your web keys.</li>
<li>To pass these parameters, many inventory scripts come with an additional configuration file that is formatted in .ini style.</li>
<li>The community-provided ec2.py script, for instance, comes with an ec2.ini parameter file.</li>
</ul>
<p>Another feature that is seen in many inventory scripts is cache management:</p>
<ul>
<li>Can use a cache to store names and parameters of recently discovered hosts.</li>
<li>If a cache is provided, options exist to manage the cache, allowing you, for instance, to make sure that the inventory information really is recently discovered.</li>
</ul>

          
          
          
        </div>
        
        

        

        

      </div>

      
      
        
        
          
          
        
        
        
        <script
          type="text/javascript"
          src="/js/page.min.54b6f4371722649edbe871e431d8670d670878c22be8f36e229fe53cc9b786fe25a834def5e6de621f7a3e37b72bc8cd73839aa5ed907ed6cbd45cd3e1b0fa20.js"
          integrity="sha512-VLb0NxciZJ7b6HHkMdhnDWcIeMIr6PNuIp/lPMm3hv4lqDTe9ebeYh96Pje3K8jNc4Oape2QftbL1FzT4bD6IA=="
          data-oid="views_tech/ansible/ansible inventory.md"
          data-oid-likes="likes_tech/ansible/ansible inventory.md"></script>
      
    </section>

    
    <footer class="pt-8 max-w-prose print:hidden">
      

      
    </footer>
  </article>

        


  






<div
  id="scroll-to-top"
  class="fixed bottom-6 end-6 z-50 transform translate-y-4 opacity-0 duration-200">
  <a
    href="#the-top"
    class="pointer-events-auto flex h-12 w-12 items-center justify-center rounded-full bg-neutral/50 text-xl text-neutral-700 hover:text-primary-600 dark:bg-neutral-800/50 dark:text-neutral dark:hover:text-primary-400"
    aria-label="Scroll to top"
    title="Scroll to top">
    &uarr;
  </a>
</div>

      </main><footer id="site-footer" class="py-10 print:hidden">
  
  
    
      
      
        
      
      
      
      
      <nav class="flex flex-row pb-4 text-base font-medium text-neutral-500 dark:text-neutral-400 overflow-x-auto py-2">
        <ul class="flex list-none flex-row">
          
            <li class=" flex mb-1 text-end sm:mb-0 sm:me-7 sm:last:me-0 me-4">
              <a
                class="decoration-primary-500 hover:underline hover:decoration-2 hover:underline-offset-2 flex items-center"
                href=""
                title="">
                
                
              </a>
            </li>
          
        </ul>
      </nav>
    
  
  <div class="flex items-center justify-between">
    
    
      <p class="text-sm text-neutral-500 dark:text-neutral-400">
          &copy;
          2025
          David Thomas
      </p>
    

    
    
  </div>
  
    <script>
      mediumZoom(document.querySelectorAll("img:not(.nozoom)"), {
        margin: 24,
        background: "rgba(0,0,0,0.5)",
        scrollOffset: 0,
      });
    </script>
  
  
  
  <script
    type="text/javascript"
    src="/js/process.min.ee03488f19c93c2efb199e2e3014ea5f3cb2ce7d45154adb3399a158cac27ca52831db249ede5bb602700ef87eb02434139de0858af1818ab0fb4182472204a4.js"
    integrity="sha512-7gNIjxnJPC77GZ4uMBTqXzyyzn1FFUrbM5mhWMrCfKUoMdsknt5btgJwDvh&#43;sCQ0E53ghYrxgYqw&#43;0GCRyIEpA=="></script>
  
  
</footer>
<div
  id="search-wrapper"
  class="invisible fixed inset-0 flex h-screen w-screen cursor-default flex-col bg-neutral-500/50 p-4 backdrop-blur-sm dark:bg-neutral-900/50 sm:p-6 md:p-[10vh] lg:p-[12vh] z-500"
  data-url="http://localhost:1313/">
  <div
    id="search-modal"
    class="flex flex-col w-full max-w-3xl min-h-0 mx-auto border rounded-md shadow-lg top-20 border-neutral-200 bg-neutral dark:border-neutral-700 dark:bg-neutral-800">
    <header class="relative z-10 flex items-center justify-between flex-none px-2">
      <form class="flex items-center flex-auto min-w-0">
        <div class="flex items-center justify-center w-8 h-8 text-neutral-400">
          <span class="relative block icon"><svg aria-hidden="true" focusable="false" data-prefix="fas" data-icon="search" class="svg-inline--fa fa-search fa-w-16" role="img" xmlns="http://www.w3.org/2000/svg" viewBox="0 0 512 512"><path fill="currentColor" d="M505 442.7L405.3 343c-4.5-4.5-10.6-7-17-7H372c27.6-35.3 44-79.7 44-128C416 93.1 322.9 0 208 0S0 93.1 0 208s93.1 208 208 208c48.3 0 92.7-16.4 128-44v16.3c0 6.4 2.5 12.5 7 17l99.7 99.7c9.4 9.4 24.6 9.4 33.9 0l28.3-28.3c9.4-9.4 9.4-24.6.1-34zM208 336c-70.7 0-128-57.2-128-128 0-70.7 57.2-128 128-128 70.7 0 128 57.2 128 128 0 70.7-57.2 128-128 128z"/></svg>
</span>
        </div>
        <input
          type="search"
          id="search-query"
          class="flex flex-auto h-12 mx-1 bg-transparent appearance-none focus:outline-dotted focus:outline-2 focus:outline-transparent"
          placeholder="Search"
          tabindex="0">
      </form>
      <button
        id="close-search-button"
        class="flex items-center justify-center w-8 h-8 text-neutral-700 hover:text-primary-600 dark:text-neutral dark:hover:text-primary-400"
        title="Close (Esc)">
        <span class="relative block icon"><svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 320 512"><path fill="currentColor" d="M310.6 361.4c12.5 12.5 12.5 32.75 0 45.25C304.4 412.9 296.2 416 288 416s-16.38-3.125-22.62-9.375L160 301.3L54.63 406.6C48.38 412.9 40.19 416 32 416S15.63 412.9 9.375 406.6c-12.5-12.5-12.5-32.75 0-45.25l105.4-105.4L9.375 150.6c-12.5-12.5-12.5-32.75 0-45.25s32.75-12.5 45.25 0L160 210.8l105.4-105.4c12.5-12.5 32.75-12.5 45.25 0s12.5 32.75 0 45.25l-105.4 105.4L310.6 361.4z"/></svg>
</span>
      </button>
    </header>
    <section class="flex-auto px-2 overflow-auto">
      <ul id="search-results">
        
      </ul>
    </section>
  </div>
</div>

    </div>
  </body>
  
</html>

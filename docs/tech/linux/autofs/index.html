<!doctype html>
<html
  lang="en"
  dir="ltr"
  class="scroll-smooth"
  data-default-appearance="light"
  data-auto-appearance="false"><head><script src="/livereload.js?mindelay=10&amp;v=2&amp;port=1313&amp;path=livereload" data-no-instant defer></script>
  <meta charset="utf-8">
  
    <meta http-equiv="content-language" content="en">
  
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <meta http-equiv="X-UA-Compatible" content="ie=edge">
  <meta name="theme-color">

  
  
    <title>AutoFS &middot; </title>
    <meta name="title" content="AutoFS &middot; ">
  

  
  
    <meta name="description" content="Managing AutoFS">
  
  
  
  
  <link rel="canonical" href="http://localhost:1313/tech/linux/autofs/">
  

  
  
    <meta name="author" content="David Thomas">
  
  

  
  <meta property="og:url" content="http://localhost:1313/tech/linux/autofs/">
  <meta property="og:title" content="AutoFS">
  <meta property="og:description" content="Managing AutoFS">
  <meta property="og:locale" content="en">
  <meta property="og:type" content="article">
    <meta property="article:section" content="tech">

  
  <meta name="twitter:card" content="summary">
  <meta name="twitter:title" content="AutoFS">
  <meta name="twitter:description" content="Managing AutoFS">

  
  
  
  
    
      
    
  
    
      
    
  
    
      
    
  
  
    
  

  
  
  
  
  
  

  

  
  
  
  
  
  
  
    
  
  
    
  
  
  <link
    type="text/css"
    rel="stylesheet"
    href="/css/main.bundle.min.278a55d3e0b39215730b0c642c7c22cc020054272d3850d92c957cddf6209cf18e0ed01f082db397c8c048c30e727b44ca408c350384ca92d5f37c62d008cbd8.css"
    integrity="sha512-J4pV0&#43;CzkhVzCwxkLHwizAIAVCctOFDZLJV83fYgnPGODtAfCC2zl8jASMMOcntEykCMNQOEypLV83xi0AjL2A==">

  
  
  <script
    type="text/javascript"
    src="/js/appearance.min.6f41174b3a05b680820fe08cadbfa5fb7a7ca347b76a0955cdc68b9d8aca1ce24f0547e138cea33bcc7904d551a90afcb1cc7f2d9fe8557075d501419046c08c.js"
    integrity="sha512-b0EXSzoFtoCCD&#43;CMrb&#43;l&#43;3p8o0e3aglVzcaLnYrKHOJPBUfhOM6jO8x5BNVRqQr8scx/LZ/oVXB11QFBkEbAjA=="></script>
  
  
  
  
  
  
    
    <script src="/lib/zoom/zoom.min.umd.a527109b68c082a70f3697716dd72a9d5aa8b545cf800cecbbc7399f2ca6f6e0ce3e431f2062b48bbfa47c9ea42822714060bef309be073f49b9c0e30d318d7b.js" integrity="sha512-pScQm2jAgqcPNpdxbdcqnVqotUXPgAzsu8c5nyym9uDOPkMfIGK0i7&#43;kfJ6kKCJxQGC&#43;8wm&#43;Bz9JucDjDTGNew=="></script>
  

  
  
  
    
  
  
    
  
  
    
  
  
  
  
  
  
    
    <script
      defer
      type="text/javascript"
      id="script-bundle"
      src="/js/main.bundle.min.9cc802d09f28c6af56ceee7bc6e320a39251fdae98243f2a9942f221ac57a9f49c51609699a91794a7b2580ee1deaa8e4d794a68ffa94aa317c66e893ce51e02.js"
      integrity="sha512-nMgC0J8oxq9Wzu57xuMgo5JR/a6YJD8qmULyIaxXqfScUWCWmakXlKeyWA7h3qqOTXlKaP&#43;pSqMXxm6JPOUeAg=="
      data-copy="Copy"
      data-copied="Copied"></script>
  

  
  

<script src="/lib/jquery/jquery.slim.min.b0dca576e87d7eaa5850ae4e61759c065786cdb6489d68fcc82240539eebd5da522bdb4fda085ffd245808c8fe2acb2516408eb774ef26b5f6015fc6737c0ea8.js" integrity="sha512-sNylduh9fqpYUK5OYXWcBleGzbZInWj8yCJAU57r1dpSK9tP2ghf/SRYCMj&#43;KsslFkCOt3TvJrX2AV/Gc3wOqA=="></script>


























  

  

  

  

  





  
  
    <link rel="apple-touch-icon" sizes="180x180" href="/apple-touch-icon.png">
    <link rel="icon" type="image/png" sizes="32x32" href="/favicon-32x32.png">
    <link rel="icon" type="image/png" sizes="16x16" href="/favicon-16x16.png">
    <link rel="manifest" href="/site.webmanifest">
  

  
  <script type="application/ld+json">
  [{
    "@context": "https://schema.org",
    "@type": "Article",
    "articleSection": "",
    "name": "AutoFS",
    "headline": "AutoFS",
    "description": "Managing AutoFS",
    "abstract": "\u003ch2 class=\u0022relative group\u0022\u003eAutoFS\n    \u003cdiv id=\u0022autofs\u0022 class=\u0022anchor\u0022\u003e\u003c\/div\u003e\n    \n    \u003cspan\n        class=\u0022absolute top-0 w-6 transition-opacity opacity-0 -start-6 not-prose group-hover:opacity-100 select-none\u0022\u003e\n        \u003ca class=\u0022text-primary-300 dark:text-neutral-700 !no-underline\u0022 href=\u0022#autofs\u0022 aria-label=\u0022Anchor\u0022\u003e#\u003c\/a\u003e\n    \u003c\/span\u003e\n    \n\u003c\/h2\u003e\n\u003cul\u003e\n\u003cli\u003eAutomatically mount and unmount on clients during runtime and system reboots.\u003c\/li\u003e\n\u003cli\u003eTriggers mount or unmount action based on mount point activity.\u003c\/li\u003e\n\u003cli\u003eClient-side service\u003c\/li\u003e\n\u003cli\u003eMount an NFS share on demand\u003c\/li\u003e\n\u003cli\u003eEntry placed in AutoFS config files.\u003c\/li\u003e\n\u003cli\u003eAutomatically mounts share upon detecting activity in it\u0026rsquo;s mount point. (touch, ls, cd)\u003c\/li\u003e\n\u003cli\u003eunmounts share if the share hasn\u0026rsquo;t been accessed for a predefined period of time.\u003c\/li\u003e\n\u003cli\u003eMounts managed with autofs should not be mounted manually via \/etc\/fstab to avoid inconsistencies.\u003c\/li\u003e\n\u003cli\u003eSaves Kernel from having to maintain unused NFS shares. (Improved performance!)\u003c\/li\u003e\n\u003cli\u003eNFS shares are defined in config files called maps (\u003cem\u003e\/etc\/\u003c\/em\u003e or \u003cem\u003e\/etc\/auto.master.d\/\u003c\/em\u003e)\u003c\/li\u003e\n\u003cli\u003eDoes not use \/etc\/fstab.\u003c\/li\u003e\n\u003cli\u003eDoes not require root to mount a share (fstab does).\u003c\/li\u003e\n\u003cli\u003ePrevents client from hanging if share is down.\u003c\/li\u003e\n\u003cli\u003eShare is unmounted if not accessed for 5 minutes (default)\u003c\/li\u003e\n\u003cli\u003eSupports wildcard characters or environment variables.\u003c\/li\u003e\n\u003cli\u003eAutomount daemon\n\u003cul\u003e\n\u003cli\u003ein the userland mounts configured shares automatically upon access.\u003c\/li\u003e\n\u003cli\u003einvoked at system boot.\u003c\/li\u003e\n\u003cli\u003eReads AutoFS master map and create initial mount point entries. (not mounting yet)\u003c\/li\u003e\n\u003cli\u003eDoes not mount shares until user activity is detected.\u003c\/li\u003e\n\u003cli\u003eUnmounts after set timeframe of inactivity.\u003c\/li\u003e\n\u003c\/ul\u003e\n\u003c\/li\u003e\n\u003cli\u003eUse the mount command on a share to verify the path of the AutoFS map, file system type, and options used during mount.\u003c\/li\u003e\n\u003c\/ul\u003e\n\u003cp\u003e\u003cem\u003e\/etc\/autofs.conf\/\u003c\/em\u003e preset Directives:\nmaster_map_name=auto.master\ntimeout = 300\nnegative_timeout = 60\nmount_nfs_default_protocol = 4\nlogging = none\u003c\/p\u003e",
    "inLanguage": "en",
    "url" : "http://localhost:1313/tech/linux/autofs/",
    "author" : {
      "@type": "Person",
      "name": "David Thomas"
    },
    
    
    
    
    
    
    
    
    "mainEntityOfPage": "true",
    "wordCount": "2023"
  }]
  </script>



  
  

  
  

  
  

  
  
    
      <script src="https://www.gstatic.com/firebasejs/8.10.0/firebase-app.js"></script>
      <script src="https://www.gstatic.com/firebasejs/8.10.0/firebase-firestore.js"></script>
      <script src="https://www.gstatic.com/firebasejs/8.10.0/firebase-auth.js"></script>
      <script>

    const firebaseConfig = {
      apiKey: "AIzaSyApsKLCbGb5fkkrzxABOtl3-OUuBcRPVsc",
      authDomain: "davidwrites-89dd7.firebaseapp.com",
      projectId: "davidwrites-89dd7",
      storageBucket: "davidwrites-89dd7.firebasestorage.app",
      messagingSenderId: "433139099634",
      appId: "1:433139099634:web:c14275555bd7171e6c6d6b",
      measurementId: "G-XX5507B82W"
    };

        var app = firebase.initializeApp(firebaseConfig);
        var db = firebase.firestore();
        var auth = firebase.auth();

      </script>
    
  

  
  
</head>







  
    
  







  
    
  






  
  
  <body class="flex flex-col h-screen m-auto leading-7 max-w-7xl px-6 sm:px-14 md:px-24 lg:px-32 text-lg bg-neutral text-neutral-900 dark:bg-neutral-800 dark:text-neutral scrollbar-thin scrollbar-track-neutral-200 scrollbar-thumb-neutral-400 dark:scrollbar-track-neutral-800 dark:scrollbar-thumb-neutral-600">
    <div id="the-top" class="absolute flex self-center">
      <a
        class="px-3 py-1 text-sm -translate-y-8 rounded-b-lg bg-primary-200 focus:translate-y-0 dark:bg-neutral-600"
        href="#main-content">
        <span class="font-bold text-primary-600 pe-2 dark:text-primary-400">&darr;</span>
        Skip to main content
      </a>
    </div>
    
    
      













<div
  class="main-menu flex items-center justify-between py-6 md:justify-start gap-x-3 pt-[2px] pr-2 md:pr-4 pb-[3px] pl-0">
  
  
    
    
      <div>
        <a href="/" class="flex">
          <span class="sr-only"></span>
          
            <img
              src="/img/logo.png"
              width="200"
              height="37"
              class="logo max-h-[5rem] max-w-[5rem] object-scale-down object-left nozoom"
              alt="">
          
        </a>
      </div>
    

  <div class="flex flex-1 items-center justify-between">
    <nav class="flex space-x-3">
      
    </nav>
    
  <nav class="hidden md:flex items-center gap-x-5 md:ml-12 h-12">
    
      
        
  <a
  href="/tech/"
  
  class="flex items-center hover:text-primary-600 dark:hover:text-primary-400"
  aria-label="Tech"
  title="">
  
  
    <p class="text-base font-medium">
      Tech
    </p>
  
</a>



      
        
  <a
  href="/notes/"
  
  class="flex items-center hover:text-primary-600 dark:hover:text-primary-400"
  aria-label="Notes"
  title="Book Notes &amp; Reviews">
  
  
    <p class="text-base font-medium">
      Notes
    </p>
  
</a>



      
        
  <a
  href="/articles/"
  
  class="flex items-center hover:text-primary-600 dark:hover:text-primary-400"
  aria-label="Articles"
  title="Articles">
  
  
    <p class="text-base font-medium">
      Articles
    </p>
  
</a>



      
        
  <a
  href="/now/"
  
  class="flex items-center hover:text-primary-600 dark:hover:text-primary-400"
  aria-label="Now"
  title="Now">
  
  
    <p class="text-base font-medium">
      Now
    </p>
  
</a>



      
        
  <a
  href=""
  
  class="flex items-center hover:text-primary-600 dark:hover:text-primary-400"
  
  title="">
  
  
</a>



      
    

    

    

    
      <button
        id="search-button"
        aria-label="Search"
        class="text-base hover:text-primary-600 dark:hover:text-primary-400"
        title="Search (/)">
        <span class="relative block icon"><svg aria-hidden="true" focusable="false" data-prefix="fas" data-icon="search" class="svg-inline--fa fa-search fa-w-16" role="img" xmlns="http://www.w3.org/2000/svg" viewBox="0 0 512 512"><path fill="currentColor" d="M505 442.7L405.3 343c-4.5-4.5-10.6-7-17-7H372c27.6-35.3 44-79.7 44-128C416 93.1 322.9 0 208 0S0 93.1 0 208s93.1 208 208 208c48.3 0 92.7-16.4 128-44v16.3c0 6.4 2.5 12.5 7 17l99.7 99.7c9.4 9.4 24.6 9.4 33.9 0l28.3-28.3c9.4-9.4 9.4-24.6.1-34zM208 336c-70.7 0-128-57.2-128-128 0-70.7 57.2-128 128-128 70.7 0 128 57.2 128 128 0 70.7-57.2 128-128 128z"/></svg>
</span>
      </button>
    

    
  </nav>

    
  <div class="flex md:hidden items-center gap-x-5 md:ml-12 h-12">
    <span></span>

    

    

    
      <button
        id="search-button-mobile"
        aria-label="Search"
        class="text-base hover:text-primary-600 dark:hover:text-primary-400"
        title="Search (/)">
        <span class="relative block icon"><svg aria-hidden="true" focusable="false" data-prefix="fas" data-icon="search" class="svg-inline--fa fa-search fa-w-16" role="img" xmlns="http://www.w3.org/2000/svg" viewBox="0 0 512 512"><path fill="currentColor" d="M505 442.7L405.3 343c-4.5-4.5-10.6-7-17-7H372c27.6-35.3 44-79.7 44-128C416 93.1 322.9 0 208 0S0 93.1 0 208s93.1 208 208 208c48.3 0 92.7-16.4 128-44v16.3c0 6.4 2.5 12.5 7 17l99.7 99.7c9.4 9.4 24.6 9.4 33.9 0l28.3-28.3c9.4-9.4 9.4-24.6.1-34zM208 336c-70.7 0-128-57.2-128-128 0-70.7 57.2-128 128-128 70.7 0 128 57.2 128 128 0 70.7-57.2 128-128 128z"/></svg>
</span>
      </button>
    

    
  </div>

  </div>
  
  <div class="-my-2 md:hidden">
    <div id="menu-button" class="block">
      
        <div class="cursor-pointer hover:text-primary-600 dark:hover:text-primary-400">
          <span class="relative block icon"><svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 448 512"><path fill="currentColor" d="M0 96C0 78.33 14.33 64 32 64H416C433.7 64 448 78.33 448 96C448 113.7 433.7 128 416 128H32C14.33 128 0 113.7 0 96zM0 256C0 238.3 14.33 224 32 224H416C433.7 224 448 238.3 448 256C448 273.7 433.7 288 416 288H32C14.33 288 0 273.7 0 256zM416 448H32C14.33 448 0 433.7 0 416C0 398.3 14.33 384 32 384H416C433.7 384 448 398.3 448 416C448 433.7 433.7 448 416 448z"/></svg>
</span>
        </div>
        <div
          id="menu-wrapper"
          class="fixed inset-0 z-30 invisible w-screen h-screen m-0 overflow-auto transition-opacity opacity-0 cursor-default bg-neutral-100/50 backdrop-blur-sm dark:bg-neutral-900/50 pt-[5px]">
          <ul
            class="flex space-y-2 mt-3 flex-col items-end w-full px-6 py-6 mx-auto overflow-visible list-none text-end max-w-7xl">
            <li id="menu-close-button">
              <span
                class="cursor-pointer inline-block align-text-bottom hover:text-primary-600 dark:hover:text-primary-400">
                <span class="relative block icon"><svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 320 512"><path fill="currentColor" d="M310.6 361.4c12.5 12.5 12.5 32.75 0 45.25C304.4 412.9 296.2 416 288 416s-16.38-3.125-22.62-9.375L160 301.3L54.63 406.6C48.38 412.9 40.19 416 32 416S15.63 412.9 9.375 406.6c-12.5-12.5-12.5-32.75 0-45.25l105.4-105.4L9.375 150.6c-12.5-12.5-12.5-32.75 0-45.25s32.75-12.5 45.25 0L160 210.8l105.4-105.4c12.5-12.5 32.75-12.5 45.25 0s12.5 32.75 0 45.25l-105.4 105.4L310.6 361.4z"/></svg>
</span>
              </span>
            </li>

            
              
  <li class="mt-1">
  <a
    href="/tech/"
    
    class="flex items-center hover:text-primary-600 dark:hover:text-primary-400"
    aria-label="Tech"
    title="">
    
    
      <p class="text-bg font-bg">
        Tech
      </p>
    
  </a>
</li>



            
              
  <li class="mt-1">
  <a
    href="/notes/"
    
    class="flex items-center hover:text-primary-600 dark:hover:text-primary-400"
    aria-label="Notes"
    title="Book Notes &amp; Reviews">
    
    
      <p class="text-bg font-bg">
        Notes
      </p>
    
  </a>
</li>



            
              
  <li class="mt-1">
  <a
    href="/articles/"
    
    class="flex items-center hover:text-primary-600 dark:hover:text-primary-400"
    aria-label="Articles"
    title="Articles">
    
    
      <p class="text-bg font-bg">
        Articles
      </p>
    
  </a>
</li>



            
              
  <li class="mt-1">
  <a
    href="/now/"
    
    class="flex items-center hover:text-primary-600 dark:hover:text-primary-400"
    aria-label="Now"
    title="Now">
    
    
      <p class="text-bg font-bg">
        Now
      </p>
    
  </a>
</li>



            
              
  <li class="mt-1">
  <a
    href=""
    
    class="flex items-center hover:text-primary-600 dark:hover:text-primary-400"
    
    title="">
    
    
  </a>
</li>



            

          </ul>
          
        </div>
      
    </div>
  </div>

</div>




  <script>
    (function () {
      var $mainmenu = $(".main-menu");
      var path = window.location.pathname;
      $mainmenu.find('a[href="' + path + '"]').each(function (i, e) {
        $(e).children("p").addClass("active");
      });
    })();
  </script>


    
    <div class="relative flex flex-col grow">
      <main id="main-content" class="grow">
        
  
  <article>
    
    

    
    <header id="single_header" class="mt-5 max-w-prose">
      
      <h1 class="mt-0 text-4xl font-extrabold text-neutral-900 dark:text-neutral">
        AutoFS
      </h1>
      <div class="mt-1 mb-6 text-base text-neutral-500 dark:text-neutral-400 print:hidden">
        





  
  



  

  
  
  
    
  

  

  

  

  

  

  

  

  

  

  


  <div class="flex flex-row flex-wrap items-center">
    
    

    
    
  </div>

  

  
  

  
  



      </div>
      
        
  
  
  
  
  
  

  

  

  

  

      
    </header>

    
    <section class="flex flex-col max-w-full mt-0 prose dark:prose-invert lg:flex-row">
      
      
      
      
      
        <div class="order-first lg:ml-auto px-0 lg:order-last lg:ps-8 lg:max-w-2xs">
          <div class="toc ps-5 print:hidden lg:sticky lg:top-10">
            
              <details
  open
  id="TOCView"
  class="toc-right mt-0 overflow-y-auto overscroll-contain scrollbar-thin scrollbar-track-neutral-200 scrollbar-thumb-neutral-400 dark:scrollbar-track-neutral-800 dark:scrollbar-thumb-neutral-600 rounded-lg -ms-5 ps-5 pe-2 hidden lg:block">
  <summary
    class="block py-1 text-lg font-semibold cursor-pointer bg-neutral-100 text-neutral-800 -ms-5 ps-5 dark:bg-neutral-700 dark:text-neutral-100 lg:hidden">
    Table of Contents
  </summary>
  <div
    class="min-w-[220px] py-2 border-dotted border-s-1 -ms-5 ps-5 dark:border-neutral-600">
    <nav id="TableOfContents">
  <ul>
    <li><a href="#autofs">AutoFS</a>
      <ul>
        <li>
          <ul>
            <li><a href="#additional-directives">Additional directives:</a></li>
          </ul>
        </li>
        <li><a href="#autofs-maps">AutoFS Maps</a></li>
        <li><a href="#direct-map">Direct Map</a></li>
        <li><a href="#indirect-map">Indirect Map</a></li>
        <li><a href="#lab-access-nfs-share-using-direct-map-server10">Lab: Access NFS Share Using Direct Map (server10)</a></li>
        <li><a href="#exercise-16-4-access-nfs-share-using-indirect-map">Exercise 16-4: Access NFS Share Using Indirect Map</a></li>
        <li><a href="#automounting-user-home-directories-">Automounting User Home Directories \</a></li>
        <li><a href="#exercise-16-5-automount-user-home-directories-using-indirect-map">Exercise 16-5: Automount User Home Directories Using Indirect Map</a></li>
      </ul>
    </li>
    <li><a href="#nfs-diy-labs">NFS DIY Labs</a>
      <ul>
        <li><a href="#lab-configure-nfs-share-and-automount-with-direct-map">Lab: Configure NFS Share and Automount with Direct Map</a></li>
        <li><a href="#lab-automount-nfs-share-with-indirect-map">Lab: Automount NFS Share with Indirect Map</a></li>
      </ul>
    </li>
  </ul>
</nav>
  </div>
</details>
<details class="toc-inside mt-0 overflow-hidden rounded-lg -ms-5 ps-5 lg:hidden">
  <summary
    class="py-1 text-lg font-semibold cursor-pointer bg-neutral-100 text-neutral-800 -ms-5 ps-5 dark:bg-neutral-700 dark:text-neutral-100 lg:hidden">
    Table of Contents
  </summary>
  <div
    class="py-2 border-dotted border-neutral-300 border-s-1 -ms-5 ps-5 dark:border-neutral-600">
    <nav id="TableOfContents">
  <ul>
    <li><a href="#autofs">AutoFS</a>
      <ul>
        <li>
          <ul>
            <li><a href="#additional-directives">Additional directives:</a></li>
          </ul>
        </li>
        <li><a href="#autofs-maps">AutoFS Maps</a></li>
        <li><a href="#direct-map">Direct Map</a></li>
        <li><a href="#indirect-map">Indirect Map</a></li>
        <li><a href="#lab-access-nfs-share-using-direct-map-server10">Lab: Access NFS Share Using Direct Map (server10)</a></li>
        <li><a href="#exercise-16-4-access-nfs-share-using-indirect-map">Exercise 16-4: Access NFS Share Using Indirect Map</a></li>
        <li><a href="#automounting-user-home-directories-">Automounting User Home Directories \</a></li>
        <li><a href="#exercise-16-5-automount-user-home-directories-using-indirect-map">Exercise 16-5: Automount User Home Directories Using Indirect Map</a></li>
      </ul>
    </li>
    <li><a href="#nfs-diy-labs">NFS DIY Labs</a>
      <ul>
        <li><a href="#lab-configure-nfs-share-and-automount-with-direct-map">Lab: Configure NFS Share and Automount with Direct Map</a></li>
        <li><a href="#lab-automount-nfs-share-with-indirect-map">Lab: Automount NFS Share with Indirect Map</a></li>
      </ul>
    </li>
  </ul>
</nav>
  </div>
</details>


<script>
  (function () {
    'use strict'

    const SCROLL_OFFSET_RATIO = 0.33
    const TOC_SELECTOR = '#TableOfContents'
    const ANCHOR_SELECTOR = '.anchor'
    const TOC_LINK_SELECTOR = 'a[href^="#"]'
    const NESTED_LIST_SELECTOR = 'li ul'
    const ACTIVE_CLASS = 'active'
    let isJumpingToAnchor = false

    function getActiveAnchorId(anchors, offsetRatio) {
      const threshold = window.scrollY + window.innerHeight * offsetRatio
      const tocLinks = [...document.querySelectorAll('#TableOfContents a[href^="#"]')]
      const tocIds = new Set(tocLinks.map(link => link.getAttribute('href').substring(1)))

      if (isJumpingToAnchor) {
        for (let i = 0; i < anchors.length; i++) {
          const anchor = anchors[i]
          if (!tocIds.has(anchor.id)) continue
          const top = anchor.getBoundingClientRect().top + window.scrollY
          if (Math.abs(window.scrollY - top) < 100) {
            return anchor.id
          }
        }
      }

      for (let i = anchors.length - 1; i >= 0; i--) {
        const top = anchors[i].getBoundingClientRect().top + window.scrollY
        if (top <= threshold && tocIds.has(anchors[i].id)) {
          return anchors[i].id
        }
      }
      return anchors.find(anchor => tocIds.has(anchor.id))?.id || ''
    }

    function updateTOC({ toc, anchors, links, scrollOffset, collapseInactive }) {
      const activeId = getActiveAnchorId(anchors, scrollOffset)
      if (!activeId) return

      links.forEach(link => {
        const isActive = link.getAttribute('href') === `#${activeId}`
        link.classList.toggle(ACTIVE_CLASS, isActive)

        if (collapseInactive) {
          const ul = link.closest('li')?.querySelector('ul')
          if (ul) ul.style.display = isActive ? '' : 'none'
        }
      })

      if (collapseInactive) {
        const activeLink = toc.querySelector(`a[href="#${CSS.escape(activeId)}"]`)
        let el = activeLink
        while (el && el !== toc) {
          if (el.tagName === 'UL') el.style.display = ''
          if (el.tagName === 'LI') el.querySelector('ul')?.style.setProperty('display', '')
          el = el.parentElement
        }
      }
    }

    function initTOC() {
      const toc = document.querySelector(TOC_SELECTOR)
      if (!toc) return

      const collapseInactive = true
      const anchors = [...document.querySelectorAll(ANCHOR_SELECTOR)]
      const links = [...toc.querySelectorAll(TOC_LINK_SELECTOR)]

      if (collapseInactive) {
        toc.querySelectorAll(NESTED_LIST_SELECTOR).forEach(ul => ul.style.display = 'none')
      }

      links.forEach(link => {
        link.addEventListener('click', () => {
          isJumpingToAnchor = true
        })
      })

      const config = {
        toc,
        anchors,
        links,
        scrollOffset: SCROLL_OFFSET_RATIO,
        collapseInactive
      }

      window.addEventListener('scroll', () => updateTOC(config), { passive: true })
      window.addEventListener('hashchange', () => updateTOC(config), { passive: true })

      updateTOC(config)
    }

    document.readyState === 'loading'
      ? document.addEventListener('DOMContentLoaded', initTOC)
      : initTOC()
  })()
</script>


            
          </div>
        </div>
      


      <div class="min-w-0 min-h-0 max-w-fit">
        

        <div class="article-content max-w-prose mb-20">
          
<h2 class="relative group">AutoFS
    <div id="autofs" class="anchor"></div>
    
    <span
        class="absolute top-0 w-6 transition-opacity opacity-0 -start-6 not-prose group-hover:opacity-100 select-none">
        <a class="text-primary-300 dark:text-neutral-700 !no-underline" href="#autofs" aria-label="Anchor">#</a>
    </span>
    
</h2>
<ul>
<li>Automatically mount and unmount on clients during runtime and system reboots.</li>
<li>Triggers mount or unmount action based on mount point activity.</li>
<li>Client-side service</li>
<li>Mount an NFS share on demand</li>
<li>Entry placed in AutoFS config files.</li>
<li>Automatically mounts share upon detecting activity in it&rsquo;s mount point. (touch, ls, cd)</li>
<li>unmounts share if the share hasn&rsquo;t been accessed for a predefined period of time.</li>
<li>Mounts managed with autofs should not be mounted manually via /etc/fstab to avoid inconsistencies.</li>
<li>Saves Kernel from having to maintain unused NFS shares. (Improved performance!)</li>
<li>NFS shares are defined in config files called maps (<em>/etc/</em> or <em>/etc/auto.master.d/</em>)</li>
<li>Does not use /etc/fstab.</li>
<li>Does not require root to mount a share (fstab does).</li>
<li>Prevents client from hanging if share is down.</li>
<li>Share is unmounted if not accessed for 5 minutes (default)</li>
<li>Supports wildcard characters or environment variables.</li>
<li>Automount daemon
<ul>
<li>in the userland mounts configured shares automatically upon access.</li>
<li>invoked at system boot.</li>
<li>Reads AutoFS master map and create initial mount point entries. (not mounting yet)</li>
<li>Does not mount shares until user activity is detected.</li>
<li>Unmounts after set timeframe of inactivity.</li>
</ul>
</li>
<li>Use the mount command on a share to verify the path of the AutoFS map, file system type, and options used during mount.</li>
</ul>
<p><em>/etc/autofs.conf/</em> preset Directives:
master_map_name=auto.master
timeout = 300
negative_timeout = 60
mount_nfs_default_protocol = 4
logging = none</p>

<h4 class="relative group">Additional directives:
    <div id="additional-directives" class="anchor"></div>
    
    <span
        class="absolute top-0 w-6 transition-opacity opacity-0 -start-6 not-prose group-hover:opacity-100 select-none">
        <a class="text-primary-300 dark:text-neutral-700 !no-underline" href="#additional-directives" aria-label="Anchor">#</a>
    </span>
    
</h4>
<p><strong>master_map_name</strong></p>
<ul>
<li>
<p>Name of the master map. Default is <em>/etc/auto.master</em>
<strong>timeout</strong></p>
</li>
<li>
<p>Time in second to unmount a share.
<strong>negative_timeout</strong></p>
</li>
<li>
<p>Timeout (in seconds) value for failed mount attempts. (1 minute default)
<strong>mount_nfs_default_protocol</strong></p>
</li>
<li>
<p>Sets the NFS version used to mount shares.
<strong>logging</strong></p>
</li>
<li>
<p>Logging level (none, verbose, debug)</p>
</li>
<li>
<p>Default is none (disabled)</p>
</li>
<li>
<p>Normally left to their default values.</p>
</li>
</ul>

<h3 class="relative group">AutoFS Maps
    <div id="autofs-maps" class="anchor"></div>
    
    <span
        class="absolute top-0 w-6 transition-opacity opacity-0 -start-6 not-prose group-hover:opacity-100 select-none">
        <a class="text-primary-300 dark:text-neutral-700 !no-underline" href="#autofs-maps" aria-label="Anchor">#</a>
    </span>
    
</h3>
<ul>
<li>Where AutoFS finds the shares to mount and their locations.</li>
<li>Also tells Autofs what options to use.</li>
</ul>
<p><strong>Map Types</strong>:</p>
<ul>
<li>master</li>
<li>direct</li>
<li>indirect</li>
</ul>
<p><strong>Master Map</strong></p>
<p>Define entries for indirect and direct maps.</p>
<ul>
<li><em>/etc/auto.master</em> is default</li>
<li>Default is defined in <em>/etc/autofs.conf</em> with <strong>master_map_name</strong> directive.</li>
<li>May be used to define entries for indirect and direct maps.
<ul>
<li>But it is recommended to store user-defined maps in <em>/etc/auto.master.d/</em>
<ul>
<li>AutoFS service parses this at startup.</li>
</ul>
</li>
</ul>
</li>
<li>You can append an option to auto.master but it will apply globally to all subentries in the specified map file.</li>
</ul>
<p>Map entry format examples:</p>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-bash" data-lang="bash"><span class="line"><span class="cl">  /-                      /etc/auto.master.d/auto.direct   <span class="se">\#</span> Line <span class="m">1</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">  /misc                   /etc/auto.misc                   <span class="se">\#</span> Line <span class="m">2</span>
</span></span></code></pre></div>
<h3 class="relative group">Direct Map
    <div id="direct-map" class="anchor"></div>
    
    <span
        class="absolute top-0 w-6 transition-opacity opacity-0 -start-6 not-prose group-hover:opacity-100 select-none">
        <a class="text-primary-300 dark:text-neutral-700 !no-underline" href="#direct-map" aria-label="Anchor">#</a>
    </span>
    
</h3>
<pre tabindex="0"><code>/- /etc/auto.master.d/auto.direct &lt;-- defines direct map and points to auto.direct for details
</code></pre><p>Mount shares on unrelated mount points</p>
<ul>
<li>Always visible to users</li>
<li>Can exist with an indirect share under one parent directory</li>
<li>Accessing a directory containing many direct mount points mounts all shares.</li>
<li>Each direct map entry places a separate share entry to <em>/etc/mtab</em>
<ul>
<li><em>/etc/mtab</em> maintains a list of all mounted file systems whether they are local or remote.</li>
<li>Updated whenever a local file system, removable file system, or a network share is mounted or unmounted.</li>
</ul>
</li>
</ul>

<h3 class="relative group">Indirect Map
    <div id="indirect-map" class="anchor"></div>
    
    <span
        class="absolute top-0 w-6 transition-opacity opacity-0 -start-6 not-prose group-hover:opacity-100 select-none">
        <a class="text-primary-300 dark:text-neutral-700 !no-underline" href="#indirect-map" aria-label="Anchor">#</a>
    </span>
    
</h3>
<pre tabindex="0"><code>/misc /etc/auto.misc &lt;-- indirect map and points to auto.misc for details
</code></pre><p>Automount removable filesystems</p>
<ul>
<li>Mount point <em>/misc</em> precedes mount point entries in <em>/etc/auto.miscq</em></li>
<li>Used to automount removable file systems (CD, DVD, USB disks, etc.)</li>
<li>Custom indirect map files should be located in <em>/etc/auto.master.d/</em></li>
<li>Preferred over direct mount for mounting all shares under one common parent directory.</li>
<li>Become visible only after they have been accessed.</li>
<li>Local and indirect mounted shares cannot coexist under the same parent directory.</li>
<li>One entry in <em>/etc/mtab</em> gets added for each indirect map.</li>
<li>Usually better to use indirect map for automounting NFS shares.</li>
</ul>

<h3 class="relative group">Lab: Access NFS Share Using Direct Map (server10)
    <div id="lab-access-nfs-share-using-direct-map-server10" class="anchor"></div>
    
    <span
        class="absolute top-0 w-6 transition-opacity opacity-0 -start-6 not-prose group-hover:opacity-100 select-none">
        <a class="text-primary-300 dark:text-neutral-700 !no-underline" href="#lab-access-nfs-share-using-direct-map-server10" aria-label="Anchor">#</a>
    </span>
    
</h3>
<ol>
<li>Install Autofs</li>
</ol>
<pre tabindex="0"><code>sudo dnf install -y autofs
</code></pre><ol>
<li>Create mount point /autodir using mkdir</li>
</ol>
<pre tabindex="0"><code>sudo mkdir /autodir
</code></pre><ol>
<li>Add an entry to <em>/etc/auto.master</em> to point the AutoFS service to the auto.dir file for more information:</li>
</ol>
<pre tabindex="0"><code>/- /etc/auto.master.d/auto.dir
</code></pre><ol>
<li>Create <em>/etc/auto.master.d/auto.dir</em> and add the mount point, NFS server, and share info:</li>
</ol>
<pre tabindex="0"><code>/autodir server20:/common
</code></pre><ol>
<li>Start AutoFS service and enable it at startup:</li>
</ol>
<pre tabindex="0"><code>sudo systemctl enable --now autofs
</code></pre><ol>
<li>Make sure AUtoFS service is running. Use -l and &ndash;no-pager options to show full details without piping the output to a pager program (pg)</li>
</ol>
<pre tabindex="0"><code>sudo systemctl status autofs -l --no-pager
</code></pre><ol>
<li>Run ls on the mount point then verify the share is automounted and accessible with mount.</li>
</ol>
<pre tabindex="0"><code>ls /autodir
mount | grep autodir
</code></pre><ol>
<li>Wait 5 minutes and run the mount command again to see it has disappeared.</li>
</ol>
<pre tabindex="0"><code>mount | grep autodir
</code></pre>
<h3 class="relative group">Exercise 16-4: Access NFS Share Using Indirect Map
    <div id="exercise-16-4-access-nfs-share-using-indirect-map" class="anchor"></div>
    
    <span
        class="absolute top-0 w-6 transition-opacity opacity-0 -start-6 not-prose group-hover:opacity-100 select-none">
        <a class="text-primary-300 dark:text-neutral-700 !no-underline" href="#exercise-16-4-access-nfs-share-using-indirect-map" aria-label="Anchor">#</a>
    </span>
    
</h3>
<ul>
<li>configure an indirect map to automount the NFS share /common that is available from server20.</li>
<li>install the relevant software and set up AutoFS maps to support the automatic mounting.</li>
<li>Observe that the specified mount point &ldquo;autoindir&rdquo; is created automatically under /misc.</li>
</ul>
<p>Note that /common is already mounted on the /local mount point via the fstab file and it is also configured via a direct map for automounting on /autodir. There should occur no conflict in configuration or functionality among the three.</p>
<p>1. Install the autofs software package if it is not already there:</p>
<p>2. Confirm the entry for the indirect map <em>/misc</em> in the <em>/etc/auto.master</em>
file exists:</p>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-bash" data-lang="bash"><span class="line"><span class="cl"><span class="o">[</span>root@server30 common<span class="o">]</span><span class="c1"># grep ^/misc /etc/auto.master</span>
</span></span><span class="line"><span class="cl">/misc	/etc/auto.misc
</span></span></code></pre></div><p>3. Edit the <em>/etc/auto.misc</em> file and add the mount point, NFS server, and share information to it:</p>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-bash" data-lang="bash"><span class="line"><span class="cl">autoindir server30:/common
</span></span></code></pre></div><p>4. Start the AutoFS service now and set it to autostart at system reboots:</p>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-bash" data-lang="bash"><span class="line"><span class="cl"><span class="o">[</span>root@server40 /<span class="o">]</span><span class="c1"># systemctl enable --now autofs</span>
</span></span></code></pre></div><p>5. Verify the operational status of the AutoFS service. Use the -l and --no-pager options to show full details without piping the output to a pager program (the pg command in this case):</p>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-bash" data-lang="bash"><span class="line"><span class="cl"><span class="o">[</span>root@server40 /<span class="o">]</span><span class="c1"># systemctl status autofs -l --no-pager</span>
</span></span></code></pre></div><p><br>
6. Run the ls command on the mount point /misc/autoindir and then grep for both auto.misc and autoindir on the mount command output to verify that the share is automounted and accessible:</p>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-bash" data-lang="bash"><span class="line"><span class="cl"><span class="o">[</span>root@server40 /<span class="o">]</span><span class="c1"># ls /misc/autoindir</span>
</span></span><span class="line"><span class="cl">test.text
</span></span></code></pre></div><div class="highlight"><pre tabindex="0" class="chroma"><code class="language-bash" data-lang="bash"><span class="line"><span class="cl"><span class="o">[</span>root@server40 /<span class="o">]</span><span class="c1"># mount | egrep &#39;auto.misc|autoindir&#39;</span>
</span></span><span class="line"><span class="cl">/etc/auto.misc on /misc <span class="nb">type</span> autofs <span class="o">(</span>rw,relatime,fd<span class="o">=</span>7,pgrp<span class="o">=</span>3321,timeout<span class="o">=</span>300,minproto<span class="o">=</span>5,maxproto<span class="o">=</span>5,indirect,pipe_ino<span class="o">=</span>31779<span class="o">)</span>
</span></span><span class="line"><span class="cl">server30:/common on /misc/autoindir <span class="nb">type</span> nfs4 <span class="o">(</span>rw,relatime,vers<span class="o">=</span>4.2,rsize<span class="o">=</span>262144,wsize<span class="o">=</span>262144,namlen<span class="o">=</span>255,hard,proto<span class="o">=</span>tcp,timeo<span class="o">=</span>600,retrans<span class="o">=</span>2,sec<span class="o">=</span>sys,clientaddr<span class="o">=</span>192.168.0.40,local_lock<span class="o">=</span>none,addr<span class="o">=</span>192.168.0.30<span class="o">)</span>
</span></span></code></pre></div><ul>
<li><em>/misc/autoindir</em> has been auto generated.</li>
<li>You can use the umbrella mount point /misc to mount additional auto-generated mount points.</li>
</ul>

<h3 class="relative group">Automounting User Home Directories \
    <div id="automounting-user-home-directories-" class="anchor"></div>
    
    <span
        class="absolute top-0 w-6 transition-opacity opacity-0 -start-6 not-prose group-hover:opacity-100 select-none">
        <a class="text-primary-300 dark:text-neutral-700 !no-underline" href="#automounting-user-home-directories-" aria-label="Anchor">#</a>
    </span>
    
</h3>
<p>AutoFS allows us to automount user home directories by exploiting two special characters in indirect maps.</p>
<p><strong>asterisk (*)</strong></p>
<ul>
<li>Replaces the references to specific mount points</li>
</ul>
<p><strong>ampersand (&amp;)</strong></p>
<ul>
<li>
<p>Substitutes the references to NFS servers and shared subdirectories.</p>
</li>
<li>
<p>With user home directories located under /home, on one or more NFS servers, the AutoFS service will connect with all of them simultaneously when a user attempts to log on to a client.</p>
</li>
<li>
<p>The service will mount only that specific user&rsquo;s home directory rather than the entire /home.</p>
</li>
<li>
<p>The indirect map entry for this type of substitution is defined in an indirect map, such as <em>/etc/auto.master.d/auto.home</em>.</p>
</li>
</ul>
<p><code>* -rw &amp;:/home/&amp;</code></p>
<ul>
<li>
<p>With this entry in place, there is no need to update any AutoFS configuration files if additional NFS servers with /home shared are added or removed.</p>
</li>
<li>
<p>If user home directories are added or deleted, there will be no impact on the functionality of AutoFS.</p>
</li>
<li>
<p>If there is only one NFS server sharing the home directories, you can simply specify its name in lieu of the first &amp; symbol in the above entry.</p>
</li>
</ul>

<h3 class="relative group">Exercise 16-5: Automount User Home Directories Using Indirect Map
    <div id="exercise-16-5-automount-user-home-directories-using-indirect-map" class="anchor"></div>
    
    <span
        class="absolute top-0 w-6 transition-opacity opacity-0 -start-6 not-prose group-hover:opacity-100 select-none">
        <a class="text-primary-300 dark:text-neutral-700 !no-underline" href="#exercise-16-5-automount-user-home-directories-using-indirect-map" aria-label="Anchor">#</a>
    </span>
    
</h3>
<p>There are two portions for this exercise. The first portion should be done on server20 (NFS server) and the second portion on server10 (NFS client) as user1 with sudo where required.</p>
<p>first portion</p>
<ul>
<li>create a user account called user30 with UID 3000.</li>
<li>add the /home directory to the list of NFS shares so that it becomes available for remote mount.</li>
</ul>
<p>second portion</p>
<ul>
<li>create a user account called user30 with UID 3000, base directory /nfshome, and no home directory.</li>
<li>create an umbrella mount point called /nfshome for mounting the user home directory from the NFS server.</li>
<li>install the relevant software and establish an indirect map to automount the remote home directory of user30 under /nfshome.</li>
<li>observe that the home directory is automounted under /nfshome when you sign in as user30.</li>
</ul>
<p>On NFS server server20:</p>
<p>1. Create a user account called user30 with UID 3000 (-u) and assign
password &ldquo;password1&rdquo;:</p>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-bash" data-lang="bash"><span class="line"><span class="cl"><span class="o">[</span>root@server30 common<span class="o">]</span><span class="c1"># useradd -u 3000 user30</span>
</span></span><span class="line"><span class="cl"><span class="o">[</span>root@server30 common<span class="o">]</span><span class="c1"># echo password1 | sudo passwd --stdin user30</span>
</span></span><span class="line"><span class="cl">Changing password <span class="k">for</span> user user30.
</span></span><span class="line"><span class="cl">passwd: all authentication tokens updated successfully.
</span></span></code></pre></div><p>2. Edit the /etc/exports file and add an entry for /home (do not modify or remove the previous entry):
<code>/home server40(rw)</code></p>
<p>3. Export all the shares listed in the /etc/exports file:</p>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-bash" data-lang="bash"><span class="line"><span class="cl"><span class="o">[</span>root@server30 common<span class="o">]</span><span class="c1"># sudo exportfs -avr</span>
</span></span><span class="line"><span class="cl">exporting server40.example.com:/home
</span></span><span class="line"><span class="cl">exporting server40.example.com:/common
</span></span></code></pre></div><p>On NFS client server10:</p>
<p>1. Install the autofs software package if it is not already there:
<code>dnf install autofs</code></p>
<p>2. Create a user account called user30 with UID 3000 (-u), base home directory location /nfshome (-b), no home directory (-M), and password &ldquo;password1&rdquo;:</p>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-bash" data-lang="bash"><span class="line"><span class="cl"><span class="o">[</span>root@server40 misc<span class="o">]</span><span class="c1"># sudo useradd -u 3000 -b /nfshome -M user30</span>
</span></span><span class="line"><span class="cl"><span class="o">[</span>root@server40 misc<span class="o">]</span><span class="c1"># echo password1 | sudo passwd --stdin user30</span>
</span></span></code></pre></div><p>This is to ensure that the UID for the user is consistent on the server and the client to avoid access issues.</p>
<p>3. Create the umbrella mount point /nfshome to automount the user&rsquo;s home directory:</p>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-bash" data-lang="bash"><span class="line"><span class="cl">sudo mkdir /nfshome
</span></span></code></pre></div><p>4. Edit the <em>/etc/auto.master</em> file and add the mount point and indirect map location to it:
<code>/nfshome /etc/auto.master.d/auto.home</code></p>
<p>5. Create the /etc/auto.master.d/auto.home file and add the following information to it:
<code>* -rw server30:/home/&amp;</code></p>
<p>For multiple user setup, you can replace &ldquo;user30&rdquo; with the &amp; character, but ensure that those users exist on both the server and the client with consistent UIDs.</p>
<p>6. Start the AutoFS service now and set it to autostart at system reboots. This step is not required if AutoFS is already running and enabled.
<code>systemctl enable --now autofs</code></p>
<p>7. Verify the operational status of the AutoFS service. Use the -l and --no-pager options to show full details without piping the output to a pager program (the pg command):
<code>systemctl status autofs -l --no-pager</code></p>
<p>8. Log in as user30 and run the pwd, ls, and df commands for verification:</p>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-bash" data-lang="bash"><span class="line"><span class="cl"><span class="o">[</span>root@server40 nfshome<span class="o">]</span><span class="c1"># su - user30</span>
</span></span><span class="line"><span class="cl"><span class="o">[</span>user30@server40 ~<span class="o">]</span>$ ls
</span></span><span class="line"><span class="cl">user30.txt
</span></span><span class="line"><span class="cl"><span class="o">[</span>user30@server40 ~<span class="o">]</span>$ <span class="nb">pwd</span>
</span></span><span class="line"><span class="cl">/nfshome/user30
</span></span><span class="line"><span class="cl"><span class="o">[</span>user30@server40 ~<span class="o">]</span>$ df -h
</span></span><span class="line"><span class="cl">Filesystem             Size  Used Avail Use% Mounted on
</span></span><span class="line"><span class="cl">devtmpfs               4.0M     <span class="m">0</span>  4.0M   0% /dev
</span></span><span class="line"><span class="cl">tmpfs                  888M     <span class="m">0</span>  888M   0% /dev/shm
</span></span><span class="line"><span class="cl">tmpfs                  356M  5.1M  351M   2% /run
</span></span><span class="line"><span class="cl">/dev/mapper/rhel-root   17G  2.2G   15G  13% /
</span></span><span class="line"><span class="cl">/dev/sda1              960M  344M  617M  36% /boot
</span></span><span class="line"><span class="cl">tmpfs                  178M     <span class="m">0</span>  178M   0% /run/user/0
</span></span><span class="line"><span class="cl">server30:/common        17G  2.2G   15G  13% /local
</span></span><span class="line"><span class="cl">server30:/home/user30   17G  2.2G   15G  13% /nfshome/user30
</span></span></code></pre></div><p>EXAM TIP: You may need to configure AutoFS for mounting a remote user
home directory.</p>

<h2 class="relative group">NFS DIY Labs
    <div id="nfs-diy-labs" class="anchor"></div>
    
    <span
        class="absolute top-0 w-6 transition-opacity opacity-0 -start-6 not-prose group-hover:opacity-100 select-none">
        <a class="text-primary-300 dark:text-neutral-700 !no-underline" href="#nfs-diy-labs" aria-label="Anchor">#</a>
    </span>
    
</h2>

<h3 class="relative group">Lab: Configure NFS Share and Automount with Direct Map
    <div id="lab-configure-nfs-share-and-automount-with-direct-map" class="anchor"></div>
    
    <span
        class="absolute top-0 w-6 transition-opacity opacity-0 -start-6 not-prose group-hover:opacity-100 select-none">
        <a class="text-primary-300 dark:text-neutral-700 !no-underline" href="#lab-configure-nfs-share-and-automount-with-direct-map" aria-label="Anchor">#</a>
    </span>
    
</h3>
<ul>
<li>As user1 with sudo on server30, share directory /sharenfs (create it) in read/write mode using NFS.</li>
</ul>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-bash" data-lang="bash"><span class="line"><span class="cl"><span class="o">[</span>root@server30 /<span class="o">]</span><span class="c1"># mkdir /sharenfs</span>
</span></span><span class="line"><span class="cl"><span class="o">[</span>root@server30 /<span class="o">]</span><span class="c1"># chmod 777 /sharenfs</span>
</span></span><span class="line"><span class="cl"><span class="o">[</span>root@server30 /<span class="o">]</span><span class="c1"># vim /etc/exports</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="c1"># Add -&gt; /sharenfs server40(rw)</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="o">[</span>root@server30 /<span class="o">]</span><span class="c1"># dnf -y install nfs-utils</span>
</span></span><span class="line"><span class="cl"><span class="o">[</span>root@server30 /<span class="o">]</span><span class="c1"># firewall-cmd --permanent --add-service nfs</span>
</span></span><span class="line"><span class="cl"><span class="o">[</span>root@server30 /<span class="o">]</span><span class="c1"># firewall-cmd --reload</span>
</span></span><span class="line"><span class="cl">success
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="o">[</span>root@server30 /<span class="o">]</span><span class="c1"># systemctl --now enable nfs-server</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="o">[</span>root@server30 /<span class="o">]</span><span class="c1"># exportfs -av</span>
</span></span><span class="line"><span class="cl">exporting server40.example.com:/sharenfs
</span></span></code></pre></div><ul>
<li>On server40 as user1 with sudo, install the AutoFS software and start the service.</li>
</ul>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-bash" data-lang="bash"><span class="line"><span class="cl"><span class="o">[</span>root@server40 nfshome<span class="o">]</span><span class="c1"># dnf -y install autofs</span>
</span></span></code></pre></div><ul>
<li>Configure the master and a direct map to automount the share on /mntauto (create it).</li>
</ul>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-bash" data-lang="bash"><span class="line"><span class="cl"><span class="o">[</span>root@server40 ~<span class="o">]</span><span class="c1"># vim /etc/auto.master</span>
</span></span><span class="line"><span class="cl">/- /etc/auto.master.d/auto.dir
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="o">[</span>root@server40 ~<span class="o">]</span><span class="c1"># vim /etc/auto.master.d/auto.dir</span>
</span></span><span class="line"><span class="cl">/mntauto server30:/sharenfs
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="o">[</span>root@server40 /<span class="o">]</span><span class="c1"># mkdir /mntauto</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="o">[</span>root@server40 ~<span class="o">]</span><span class="c1"># systemctl enable --now autofs</span>
</span></span></code></pre></div><ul>
<li>Run ls on /mntauto to trigger the mount.</li>
</ul>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-bash" data-lang="bash"><span class="line"><span class="cl"><span class="o">[</span>root@server40 /<span class="o">]</span><span class="c1"># mount | grep mntauto</span>
</span></span><span class="line"><span class="cl">/etc/auto.master.d/auto.dir on /mntauto <span class="nb">type</span> autofs <span class="o">(</span>rw,relatime,fd<span class="o">=</span>10,pgrp<span class="o">=</span>6211,timeout<span class="o">=</span>300,minproto<span class="o">=</span>5,maxproto<span class="o">=</span>5,direct,pipe_ino<span class="o">=</span>40247<span class="o">)</span>
</span></span><span class="line"><span class="cl">server30:/sharenfs on /mntauto <span class="nb">type</span> nfs4 <span class="o">(</span>rw,relatime,vers<span class="o">=</span>4.2,rsize<span class="o">=</span>262144,wsize<span class="o">=</span>262144,namlen<span class="o">=</span>255,hard,proto<span class="o">=</span>tcp,timeo<span class="o">=</span>600,retrans<span class="o">=</span>2,sec<span class="o">=</span>sys,clientaddr<span class="o">=</span>192.168.0.40,local_lock<span class="o">=</span>none,addr<span class="o">=</span>192.168.0.30<span class="o">)</span>
</span></span></code></pre></div><ul>
<li>Use <code>df -h</code> to confirm.</li>
</ul>
<pre tabindex="0"><code>[root@server40 /]# df -h | grep mntauto
server30:/sharenfs      17G  2.2G   15G  13% /mntauto
</code></pre>
<h3 class="relative group">Lab: Automount NFS Share with Indirect Map
    <div id="lab-automount-nfs-share-with-indirect-map" class="anchor"></div>
    
    <span
        class="absolute top-0 w-6 transition-opacity opacity-0 -start-6 not-prose group-hover:opacity-100 select-none">
        <a class="text-primary-300 dark:text-neutral-700 !no-underline" href="#lab-automount-nfs-share-with-indirect-map" aria-label="Anchor">#</a>
    </span>
    
</h3>
<ul>
<li>As user1 with sudo on server40, configure the master and an indirect map to automount the share under /autoindir (create it).</li>
</ul>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-bash" data-lang="bash"><span class="line"><span class="cl"><span class="o">[</span>root@server40 /<span class="o">]</span><span class="c1"># mkdir /autoindir</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="o">[</span>root@server40 etc<span class="o">]</span><span class="c1"># vim /etc/auto.master</span>
</span></span><span class="line"><span class="cl">/autoindir /etc/auto.misc
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="o">[</span>root@server40 etc<span class="o">]</span><span class="c1"># vim /etc/auto.misc</span>
</span></span><span class="line"><span class="cl">sharenfs server30:/common
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="o">[</span>root@server40 etc<span class="o">]</span><span class="c1"># systemctl restart autofs</span>
</span></span></code></pre></div><ul>
<li>Run ls on /autoindir/sharenfs to trigger the mount.</li>
</ul>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-bash" data-lang="bash"><span class="line"><span class="cl"><span class="o">[</span>root@server40 etc<span class="o">]</span><span class="c1"># ls /autoindir/sharenfs</span>
</span></span><span class="line"><span class="cl">test.text
</span></span></code></pre></div><ul>
<li>Use <code>df -h</code> to confirm.</li>
</ul>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-bash" data-lang="bash"><span class="line"><span class="cl"><span class="o">[</span>root@server40 etc<span class="o">]</span><span class="c1"># df -h</span>
</span></span><span class="line"><span class="cl">Filesystem             Size  Used Avail Use% Mounted on
</span></span><span class="line"><span class="cl">devtmpfs               4.0M     <span class="m">0</span>  4.0M   0% /dev
</span></span><span class="line"><span class="cl">tmpfs                  888M     <span class="m">0</span>  888M   0% /dev/shm
</span></span><span class="line"><span class="cl">tmpfs                  356M  5.1M  351M   2% /run
</span></span><span class="line"><span class="cl">/dev/mapper/rhel-root   17G  2.2G   15G  13% /
</span></span><span class="line"><span class="cl">/dev/sda1              960M  344M  617M  36% /boot
</span></span><span class="line"><span class="cl">tmpfs                  178M     <span class="m">0</span>  178M   0% /run/user/0
</span></span><span class="line"><span class="cl">server30:/common        17G  2.2G   15G  13% /autoindir/sharenfs
</span></span></code></pre></div>
          
          
          
        </div>
        
        

        

        

      </div>

      
      
        
        
          
          
        
        
        
        <script
          type="text/javascript"
          src="/js/page.min.54b6f4371722649edbe871e431d8670d670878c22be8f36e229fe53cc9b786fe25a834def5e6de621f7a3e37b72bc8cd73839aa5ed907ed6cbd45cd3e1b0fa20.js"
          integrity="sha512-VLb0NxciZJ7b6HHkMdhnDWcIeMIr6PNuIp/lPMm3hv4lqDTe9ebeYh96Pje3K8jNc4Oape2QftbL1FzT4bD6IA=="
          data-oid="views_tech/linux/AutoFS.md"
          data-oid-likes="likes_tech/linux/AutoFS.md"></script>
      
    </section>

    
    <footer class="pt-8 max-w-prose print:hidden">
      

      
    </footer>
  </article>

        


  






<div
  id="scroll-to-top"
  class="fixed bottom-6 end-6 z-50 transform translate-y-4 opacity-0 duration-200">
  <a
    href="#the-top"
    class="pointer-events-auto flex h-12 w-12 items-center justify-center rounded-full bg-neutral/50 text-xl text-neutral-700 hover:text-primary-600 dark:bg-neutral-800/50 dark:text-neutral dark:hover:text-primary-400"
    aria-label="Scroll to top"
    title="Scroll to top">
    &uarr;
  </a>
</div>

      </main><footer id="site-footer" class="py-10 print:hidden">
  
  
    
      
      
        
      
      
      
      
      <nav class="flex flex-row pb-4 text-base font-medium text-neutral-500 dark:text-neutral-400 overflow-x-auto py-2">
        <ul class="flex list-none flex-row">
          
            <li class=" flex mb-1 text-end sm:mb-0 sm:me-7 sm:last:me-0 me-4">
              <a
                class="decoration-primary-500 hover:underline hover:decoration-2 hover:underline-offset-2 flex items-center"
                href=""
                title="">
                
                
              </a>
            </li>
          
        </ul>
      </nav>
    
  
  <div class="flex items-center justify-between">
    
    
      <p class="text-sm text-neutral-500 dark:text-neutral-400">
          &copy;
          2025
          David Thomas
      </p>
    

    
    
  </div>
  
    <script>
      mediumZoom(document.querySelectorAll("img:not(.nozoom)"), {
        margin: 24,
        background: "rgba(0,0,0,0.5)",
        scrollOffset: 0,
      });
    </script>
  
  
  
  <script
    type="text/javascript"
    src="/js/process.min.ee03488f19c93c2efb199e2e3014ea5f3cb2ce7d45154adb3399a158cac27ca52831db249ede5bb602700ef87eb02434139de0858af1818ab0fb4182472204a4.js"
    integrity="sha512-7gNIjxnJPC77GZ4uMBTqXzyyzn1FFUrbM5mhWMrCfKUoMdsknt5btgJwDvh&#43;sCQ0E53ghYrxgYqw&#43;0GCRyIEpA=="></script>
  
  
</footer>
<div
  id="search-wrapper"
  class="invisible fixed inset-0 flex h-screen w-screen cursor-default flex-col bg-neutral-500/50 p-4 backdrop-blur-sm dark:bg-neutral-900/50 sm:p-6 md:p-[10vh] lg:p-[12vh] z-500"
  data-url="http://localhost:1313/">
  <div
    id="search-modal"
    class="flex flex-col w-full max-w-3xl min-h-0 mx-auto border rounded-md shadow-lg top-20 border-neutral-200 bg-neutral dark:border-neutral-700 dark:bg-neutral-800">
    <header class="relative z-10 flex items-center justify-between flex-none px-2">
      <form class="flex items-center flex-auto min-w-0">
        <div class="flex items-center justify-center w-8 h-8 text-neutral-400">
          <span class="relative block icon"><svg aria-hidden="true" focusable="false" data-prefix="fas" data-icon="search" class="svg-inline--fa fa-search fa-w-16" role="img" xmlns="http://www.w3.org/2000/svg" viewBox="0 0 512 512"><path fill="currentColor" d="M505 442.7L405.3 343c-4.5-4.5-10.6-7-17-7H372c27.6-35.3 44-79.7 44-128C416 93.1 322.9 0 208 0S0 93.1 0 208s93.1 208 208 208c48.3 0 92.7-16.4 128-44v16.3c0 6.4 2.5 12.5 7 17l99.7 99.7c9.4 9.4 24.6 9.4 33.9 0l28.3-28.3c9.4-9.4 9.4-24.6.1-34zM208 336c-70.7 0-128-57.2-128-128 0-70.7 57.2-128 128-128 70.7 0 128 57.2 128 128 0 70.7-57.2 128-128 128z"/></svg>
</span>
        </div>
        <input
          type="search"
          id="search-query"
          class="flex flex-auto h-12 mx-1 bg-transparent appearance-none focus:outline-dotted focus:outline-2 focus:outline-transparent"
          placeholder="Search"
          tabindex="0">
      </form>
      <button
        id="close-search-button"
        class="flex items-center justify-center w-8 h-8 text-neutral-700 hover:text-primary-600 dark:text-neutral dark:hover:text-primary-400"
        title="Close (Esc)">
        <span class="relative block icon"><svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 320 512"><path fill="currentColor" d="M310.6 361.4c12.5 12.5 12.5 32.75 0 45.25C304.4 412.9 296.2 416 288 416s-16.38-3.125-22.62-9.375L160 301.3L54.63 406.6C48.38 412.9 40.19 416 32 416S15.63 412.9 9.375 406.6c-12.5-12.5-12.5-32.75 0-45.25l105.4-105.4L9.375 150.6c-12.5-12.5-12.5-32.75 0-45.25s32.75-12.5 45.25 0L160 210.8l105.4-105.4c12.5-12.5 32.75-12.5 45.25 0s12.5 32.75 0 45.25l-105.4 105.4L310.6 361.4z"/></svg>
</span>
      </button>
    </header>
    <section class="flex-auto px-2 overflow-auto">
      <ul id="search-results">
        
      </ul>
    </section>
  </div>
</div>

    </div>
  </body>
  
</html>

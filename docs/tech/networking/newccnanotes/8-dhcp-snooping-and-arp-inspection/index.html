<!doctype html>
<html
  lang="en"
  dir="ltr"
  class="scroll-smooth"
  data-default-appearance="dark"
  data-auto-appearance="false"><head><script src="/livereload.js?mindelay=10&amp;v=2&amp;port=1313&amp;path=livereload" data-no-instant defer></script>
  <meta charset="utf-8">
  
    <meta http-equiv="content-language" content="en">
  
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <meta http-equiv="X-UA-Compatible" content="ie=edge">
  <meta name="theme-color">

  
  
    <title> &middot; David Thomas</title>
    <meta name="title" content=" &middot; David Thomas">
  

  
  
  
  
  
  <link rel="canonical" href="http://localhost:1313/tech/networking/newccnanotes/8-dhcp-snooping-and-arp-inspection/">
  

  
  
    <meta name="author" content="David Thomas">
  
  

  
  <meta property="og:url" content="http://localhost:1313/tech/networking/newccnanotes/8-dhcp-snooping-and-arp-inspection/">
  <meta property="og:site_name" content="David Thomas">
  <meta property="og:title" content="David Thomas">
  <meta property="og:description" content="8 DHCP Snooping and ARP Inspection # Friday, October 1, 2021 11:13 AM
attacker replies with false dhcp information by naming itself as the default gatewayPc1 send all messages to another network to attacker, becoming a man-in-the-middle
attack (pc2 could forward the messages to the actual default gateway the legitimate DHCP also returns a DHCPOFFER message to host PC1, but most hosts use the
first received DHCPOFFER, and the attacker will likely be first in this scenario. DHCP Snooping Logic">
  <meta property="og:locale" content="en">
  <meta property="og:type" content="article">
    <meta property="article:section" content="tech">

  
  <meta name="twitter:card" content="summary">
  <meta name="twitter:title" content="David Thomas">
  <meta name="twitter:description" content="8 DHCP Snooping and ARP Inspection # Friday, October 1, 2021 11:13 AM
attacker replies with false dhcp information by naming itself as the default gatewayPc1 send all messages to another network to attacker, becoming a man-in-the-middle
attack (pc2 could forward the messages to the actual default gateway the legitimate DHCP also returns a DHCPOFFER message to host PC1, but most hosts use the
first received DHCPOFFER, and the attacker will likely be first in this scenario. DHCP Snooping Logic">

  
  
  
  
    
      
    
  
    
      
    
  
    
      
    
  
  
    
  

  
  
  
  
  
  

  

  
  
  
  
  
  
  
    
  
  
    
  
  
  <link
    type="text/css"
    rel="stylesheet"
    href="/css/main.bundle.min.c5c4ab59b36e3a06d6dff38478af5d2c18b2d7a3603611d7fc5647b02111f989bd5957610b6bed4d10718428186bc7c38590e84c77c0d50f401da78f4fbb5384.css"
    integrity="sha512-xcSrWbNuOgbW3/OEeK9dLBiy16NgNhHX/FZHsCER&#43;Ym9WVdhC2vtTRBxhCgYa8fDhZDoTHfA1Q9AHaePT7tThA==">

  
  
  <script
    type="text/javascript"
    src="/js/appearance.min.6f41174b3a05b680820fe08cadbfa5fb7a7ca347b76a0955cdc68b9d8aca1ce24f0547e138cea33bcc7904d551a90afcb1cc7f2d9fe8557075d501419046c08c.js"
    integrity="sha512-b0EXSzoFtoCCD&#43;CMrb&#43;l&#43;3p8o0e3aglVzcaLnYrKHOJPBUfhOM6jO8x5BNVRqQr8scx/LZ/oVXB11QFBkEbAjA=="></script>
  
  
  
  
  
  
    
    <script src="/lib/zoom/zoom.min.umd.a527109b68c082a70f3697716dd72a9d5aa8b545cf800cecbbc7399f2ca6f6e0ce3e431f2062b48bbfa47c9ea42822714060bef309be073f49b9c0e30d318d7b.js" integrity="sha512-pScQm2jAgqcPNpdxbdcqnVqotUXPgAzsu8c5nyym9uDOPkMfIGK0i7&#43;kfJ6kKCJxQGC&#43;8wm&#43;Bz9JucDjDTGNew=="></script>
  

  
  
  
    
  
  
    
  
  
    
  
  
  
  
  
  
    
    <script
      defer
      type="text/javascript"
      id="script-bundle"
      src="/js/main.bundle.min.9cc802d09f28c6af56ceee7bc6e320a39251fdae98243f2a9942f221ac57a9f49c51609699a91794a7b2580ee1deaa8e4d794a68ffa94aa317c66e893ce51e02.js"
      integrity="sha512-nMgC0J8oxq9Wzu57xuMgo5JR/a6YJD8qmULyIaxXqfScUWCWmakXlKeyWA7h3qqOTXlKaP&#43;pSqMXxm6JPOUeAg=="
      data-copy="Copy"
      data-copied="Copied"></script>
  

  
  

<script src="/lib/jquery/jquery.slim.min.b0dca576e87d7eaa5850ae4e61759c065786cdb6489d68fcc82240539eebd5da522bdb4fda085ffd245808c8fe2acb2516408eb774ef26b5f6015fc6737c0ea8.js" integrity="sha512-sNylduh9fqpYUK5OYXWcBleGzbZInWj8yCJAU57r1dpSK9tP2ghf/SRYCMj&#43;KsslFkCOt3TvJrX2AV/Gc3wOqA=="></script>


























  

  

  

  

  





  
  
    <link rel="apple-touch-icon" sizes="180x180" href="/apple-touch-icon.png">
    <link rel="icon" type="image/png" sizes="32x32" href="/favicon-32x32.png">
    <link rel="icon" type="image/png" sizes="16x16" href="/favicon-16x16.png">
    <link rel="manifest" href="/site.webmanifest">
  

  
  <script type="application/ld+json">
  [{
    "@context": "https://schema.org",
    "@type": "Article",
    "articleSection": "",
    "name": "",
    "headline": "",
    
    "abstract": "\u003ch1 class=\u0022relative group\u0022\u003e8 DHCP Snooping and ARP Inspection\n    \u003cdiv id=\u00228-dhcp-snooping-and-arp-inspection\u0022 class=\u0022anchor\u0022\u003e\u003c\/div\u003e\n    \n    \u003cspan\n        class=\u0022absolute top-0 w-6 transition-opacity opacity-0 -start-6 not-prose group-hover:opacity-100 select-none\u0022\u003e\n        \u003ca class=\u0022text-primary-300 dark:text-neutral-700 !no-underline\u0022 href=\u0022#8-dhcp-snooping-and-arp-inspection\u0022 aria-label=\u0022Anchor\u0022\u003e#\u003c\/a\u003e\n    \u003c\/span\u003e\n    \n\u003c\/h1\u003e\n\u003cp\u003eFriday, October 1, 2021 11:13 AM\u003c\/p\u003e\n\u003cul\u003e\n\u003cli\u003eattacker replies with false dhcp information by naming itself as the default gatewayPc1 send all messages to another network to attacker, becoming a man-in-the-middle\u003cbr\u003e\nattack (pc2 could forward the messages to the actual default gateway\u003c\/li\u003e\n\u003cli\u003ethe legitimate DHCP also returns a DHCPOFFER message to host PC1, but most hosts use the\u003cbr\u003e\nfirst received DHCPOFFER, and the attacker will likely be first in this scenario.\u003c\/li\u003e\n\u003c\/ul\u003e\n\u003cp\u003eDHCP Snooping Logic\u003c\/p\u003e",
    "inLanguage": "en",
    "url" : "http://localhost:1313/tech/networking/newccnanotes/8-dhcp-snooping-and-arp-inspection/",
    "author" : {
      "@type": "Person",
      "name": "David Thomas"
    },
    
    
    
    
    
    
    
    
    "mainEntityOfPage": "true",
    "wordCount": "1694"
  }]
  </script>



  
  

  
  

  
  

  
  
    
      <script src="https://www.gstatic.com/firebasejs/8.10.0/firebase-app.js"></script>
      <script src="https://www.gstatic.com/firebasejs/8.10.0/firebase-firestore.js"></script>
      <script src="https://www.gstatic.com/firebasejs/8.10.0/firebase-auth.js"></script>
      <script>

    const firebaseConfig = {
      apiKey: "AIzaSyApsKLCbGb5fkkrzxABOtl3-OUuBcRPVsc",
      authDomain: "davidwrites-89dd7.firebaseapp.com",
      projectId: "davidwrites-89dd7",
      storageBucket: "davidwrites-89dd7.firebasestorage.app",
      messagingSenderId: "433139099634",
      appId: "1:433139099634:web:c14275555bd7171e6c6d6b",
      measurementId: "G-XX5507B82W"
    };

        var app = firebase.initializeApp(firebaseConfig);
        var db = firebase.firestore();
        var auth = firebase.auth();

      </script>
    
  

  
  
</head>







  
    
  







  
    
  






  
  
  <body class="flex flex-col h-screen m-auto leading-7 max-w-7xl px-6 sm:px-14 md:px-24 lg:px-32 text-lg bg-neutral text-neutral-900 dark:bg-neutral-800 dark:text-neutral scrollbar-thin scrollbar-track-neutral-200 scrollbar-thumb-neutral-400 dark:scrollbar-track-neutral-800 dark:scrollbar-thumb-neutral-600">
    <div id="the-top" class="absolute flex self-center">
      <a
        class="px-3 py-1 text-sm -translate-y-8 rounded-b-lg bg-primary-200 focus:translate-y-0 dark:bg-neutral-600"
        href="#main-content">
        <span class="font-bold text-primary-600 pe-2 dark:text-primary-400">&darr;</span>
        Skip to main content
      </a>
    </div>
    
    
      













<div
  class="main-menu flex items-center justify-between py-6 md:justify-start gap-x-3 pt-[2px] pr-2 md:pr-4 pb-[3px] pl-0">
  
  
    
    

  <div class="flex flex-1 items-center justify-between">
    <nav class="flex space-x-3">
      
        <a href="/" class="text-base font-medium">
          David Thomas
        </a>
      
    </nav>
    
  <nav class="hidden md:flex items-center gap-x-5 md:ml-12 h-12">
    
      
        
  <div>
  <div class="cursor-pointer flex items-center nested-menu">
    
    <a
      
      aria-label="Tech"
      class="text-base font-medium hover:text-primary-600 dark:hover:text-primary-400"
      title="">
      <p>
        Tech
      </p>
    </a>
    <span>
      <span class="relative block icon"><svg
  xmlns="http://www.w3.org/2000/svg"
  viewBox="0 0 20 20"
  fill="currentColor"
  aria-hidden="true"
>
  <path
    fill-rule="evenodd"
    d="M5.23 7.21a.75.75 0 011.06.02L10 11.168l3.71-3.938a.75.75 0 111.08 1.04l-4.25 4.5a.75.75 0 01-1.08 0l-4.25-4.5a.75.75 0 01.02-1.06z"
    clip-rule="evenodd"
  />
</svg>
</span>
    </span>
  </div>
  <div class="absolute menuhide">
    <div class="pt-2 p-5 mt-2 rounded-xl backdrop-blur shadow-2xl">
      <div class="flex flex-col space-y-3">
        
          <a
            href="/tech/networking/"
            
            aria-label="Networking"
            class="flex items-center hover:text-primary-600 dark:hover:text-primary-400">
            
            <p class="text-sm font-sm" title="">
              Networking
            </p>
          </a>
        
          <a
            href="/tech/linux/"
            
            aria-label="Linux"
            class="flex items-center hover:text-primary-600 dark:hover:text-primary-400">
            
            <p class="text-sm font-sm" title="">
              Linux
            </p>
          </a>
        
          <a
            href="/tech/ansible/"
            
            aria-label="Ansible"
            class="flex items-center hover:text-primary-600 dark:hover:text-primary-400">
            
            <p class="text-sm font-sm" title="Ansible">
              Ansible
            </p>
          </a>
        
          <a
            href="/tech/podman/"
            
            aria-label="Podman"
            class="flex items-center hover:text-primary-600 dark:hover:text-primary-400">
            
            <p class="text-sm font-sm" title="">
              Podman
            </p>
          </a>
        
      </div>
    </div>
  </div>
</div>



      
        
  <a
  href="/notes/"
  
  class="flex items-center hover:text-primary-600 dark:hover:text-primary-400"
  aria-label="Notes"
  title="Book Notes &amp; Reviews">
  
  
    <p class="text-base font-medium">
      Notes
    </p>
  
</a>



      
        
  <a
  href="/articles/"
  
  class="flex items-center hover:text-primary-600 dark:hover:text-primary-400"
  aria-label="Articles"
  title="Articles">
  
  
    <p class="text-base font-medium">
      Articles
    </p>
  
</a>



      
        
  <a
  href="/now/"
  
  class="flex items-center hover:text-primary-600 dark:hover:text-primary-400"
  aria-label="Now"
  title="Now">
  
  
    <p class="text-base font-medium">
      Now
    </p>
  
</a>



      
        
  <a
  href=""
  
  class="flex items-center hover:text-primary-600 dark:hover:text-primary-400"
  
  title="">
  
  
</a>



      
    

    

    

    
      <button
        id="search-button"
        aria-label="Search"
        class="text-base hover:text-primary-600 dark:hover:text-primary-400"
        title="Search (/)">
        <span class="relative block icon"><svg aria-hidden="true" focusable="false" data-prefix="fas" data-icon="search" class="svg-inline--fa fa-search fa-w-16" role="img" xmlns="http://www.w3.org/2000/svg" viewBox="0 0 512 512"><path fill="currentColor" d="M505 442.7L405.3 343c-4.5-4.5-10.6-7-17-7H372c27.6-35.3 44-79.7 44-128C416 93.1 322.9 0 208 0S0 93.1 0 208s93.1 208 208 208c48.3 0 92.7-16.4 128-44v16.3c0 6.4 2.5 12.5 7 17l99.7 99.7c9.4 9.4 24.6 9.4 33.9 0l28.3-28.3c9.4-9.4 9.4-24.6.1-34zM208 336c-70.7 0-128-57.2-128-128 0-70.7 57.2-128 128-128 70.7 0 128 57.2 128 128 0 70.7-57.2 128-128 128z"/></svg>
</span>
      </button>
    

    
  </nav>

    
  <div class="flex md:hidden items-center gap-x-5 md:ml-12 h-12">
    <span></span>

    

    

    
      <button
        id="search-button-mobile"
        aria-label="Search"
        class="text-base hover:text-primary-600 dark:hover:text-primary-400"
        title="Search (/)">
        <span class="relative block icon"><svg aria-hidden="true" focusable="false" data-prefix="fas" data-icon="search" class="svg-inline--fa fa-search fa-w-16" role="img" xmlns="http://www.w3.org/2000/svg" viewBox="0 0 512 512"><path fill="currentColor" d="M505 442.7L405.3 343c-4.5-4.5-10.6-7-17-7H372c27.6-35.3 44-79.7 44-128C416 93.1 322.9 0 208 0S0 93.1 0 208s93.1 208 208 208c48.3 0 92.7-16.4 128-44v16.3c0 6.4 2.5 12.5 7 17l99.7 99.7c9.4 9.4 24.6 9.4 33.9 0l28.3-28.3c9.4-9.4 9.4-24.6.1-34zM208 336c-70.7 0-128-57.2-128-128 0-70.7 57.2-128 128-128 70.7 0 128 57.2 128 128 0 70.7-57.2 128-128 128z"/></svg>
</span>
      </button>
    

    
  </div>

  </div>
  
  <div class="-my-2 md:hidden">
    <div id="menu-button" class="block">
      
        <div class="cursor-pointer hover:text-primary-600 dark:hover:text-primary-400">
          <span class="relative block icon"><svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 448 512"><path fill="currentColor" d="M0 96C0 78.33 14.33 64 32 64H416C433.7 64 448 78.33 448 96C448 113.7 433.7 128 416 128H32C14.33 128 0 113.7 0 96zM0 256C0 238.3 14.33 224 32 224H416C433.7 224 448 238.3 448 256C448 273.7 433.7 288 416 288H32C14.33 288 0 273.7 0 256zM416 448H32C14.33 448 0 433.7 0 416C0 398.3 14.33 384 32 384H416C433.7 384 448 398.3 448 416C448 433.7 433.7 448 416 448z"/></svg>
</span>
        </div>
        <div
          id="menu-wrapper"
          class="fixed inset-0 z-30 invisible w-screen h-screen m-0 overflow-auto transition-opacity opacity-0 cursor-default bg-neutral-100/50 backdrop-blur-sm dark:bg-neutral-900/50 pt-[5px]">
          <ul
            class="flex space-y-2 mt-3 flex-col items-end w-full px-6 py-6 mx-auto overflow-visible list-none text-end max-w-7xl">
            <li id="menu-close-button">
              <span
                class="cursor-pointer inline-block align-text-bottom hover:text-primary-600 dark:hover:text-primary-400">
                <span class="relative block icon"><svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 320 512"><path fill="currentColor" d="M310.6 361.4c12.5 12.5 12.5 32.75 0 45.25C304.4 412.9 296.2 416 288 416s-16.38-3.125-22.62-9.375L160 301.3L54.63 406.6C48.38 412.9 40.19 416 32 416S15.63 412.9 9.375 406.6c-12.5-12.5-12.5-32.75 0-45.25l105.4-105.4L9.375 150.6c-12.5-12.5-12.5-32.75 0-45.25s32.75-12.5 45.25 0L160 210.8l105.4-105.4c12.5-12.5 32.75-12.5 45.25 0s12.5 32.75 0 45.25l-105.4 105.4L310.6 361.4z"/></svg>
</span>
              </span>
            </li>

            
              
  <li class="mt-1">
  <a
    href=""
    aria-label="Tech"
    class="flex items-center hover:text-primary-600 dark:hover:text-primary-400">
    
    <p class="text-bg font-bg" title="">
      Tech
    </p>
    <span>
      <span class="relative block icon"><svg
  xmlns="http://www.w3.org/2000/svg"
  viewBox="0 0 20 20"
  fill="currentColor"
  aria-hidden="true"
>
  <path
    fill-rule="evenodd"
    d="M5.23 7.21a.75.75 0 011.06.02L10 11.168l3.71-3.938a.75.75 0 111.08 1.04l-4.25 4.5a.75.75 0 01-1.08 0l-4.25-4.5a.75.75 0 01.02-1.06z"
    clip-rule="evenodd"
  />
</svg>
</span>
    </span>
  </a>
</li>

  <li class="mt-1">
    <a
      href="/tech/networking/"
      
      aria-label="Networking"
      class="flex items-center hover:text-primary-600 dark:hover:text-primary-400">
      
      <p class="text-sm font-small" title="">
        Networking
      </p>
    </a>
  </li>

  <li class="mt-1">
    <a
      href="/tech/linux/"
      
      aria-label="Linux"
      class="flex items-center hover:text-primary-600 dark:hover:text-primary-400">
      
      <p class="text-sm font-small" title="">
        Linux
      </p>
    </a>
  </li>

  <li class="mt-1">
    <a
      href="/tech/ansible/"
      
      aria-label="Ansible"
      class="flex items-center hover:text-primary-600 dark:hover:text-primary-400">
      
      <p class="text-sm font-small" title="Ansible">
        Ansible
      </p>
    </a>
  </li>

  <li class="mt-1">
    <a
      href="/tech/podman/"
      
      aria-label="Podman"
      class="flex items-center hover:text-primary-600 dark:hover:text-primary-400">
      
      <p class="text-sm font-small" title="">
        Podman
      </p>
    </a>
  </li>

<li class="mb-2"></li>



            
              
  <li class="mt-1">
  <a
    href="/notes/"
    
    class="flex items-center hover:text-primary-600 dark:hover:text-primary-400"
    aria-label="Notes"
    title="Book Notes &amp; Reviews">
    
    
      <p class="text-bg font-bg">
        Notes
      </p>
    
  </a>
</li>



            
              
  <li class="mt-1">
  <a
    href="/articles/"
    
    class="flex items-center hover:text-primary-600 dark:hover:text-primary-400"
    aria-label="Articles"
    title="Articles">
    
    
      <p class="text-bg font-bg">
        Articles
      </p>
    
  </a>
</li>



            
              
  <li class="mt-1">
  <a
    href="/now/"
    
    class="flex items-center hover:text-primary-600 dark:hover:text-primary-400"
    aria-label="Now"
    title="Now">
    
    
      <p class="text-bg font-bg">
        Now
      </p>
    
  </a>
</li>



            
              
  <li class="mt-1">
  <a
    href=""
    
    class="flex items-center hover:text-primary-600 dark:hover:text-primary-400"
    
    title="">
    
    
  </a>
</li>



            

          </ul>
          
        </div>
      
    </div>
  </div>

</div>




  <script>
    (function () {
      var $mainmenu = $(".main-menu");
      var path = window.location.pathname;
      $mainmenu.find('a[href="' + path + '"]').each(function (i, e) {
        $(e).children("p").addClass("active");
      });
    })();
  </script>


    
    <div class="relative flex flex-col grow">
      <main id="main-content" class="grow">
        
  
  <article>
    
    

    
    <header id="single_header" class="mt-5 max-w-prose">
      
      <h1 class="mt-0 text-4xl font-extrabold text-neutral-900 dark:text-neutral">
        
      </h1>
      <div class="mt-1 mb-6 text-base text-neutral-500 dark:text-neutral-400 print:hidden">
        





  
  



  

  
  
  
    
  

  

  

  

  

  

  

  

  

  

  


  <div class="flex flex-row flex-wrap items-center">
    
    

    
    
  </div>

  

  
  

  
  



      </div>
      
        
  
  
  
  
  
  

  

  

  

  

      
    </header>

    
    <section class="flex flex-col max-w-full mt-0 prose dark:prose-invert lg:flex-row">
      
      
      
      
      
        <div class="order-first lg:ml-auto px-0 lg:order-last lg:ps-8 lg:max-w-2xs">
          <div class="toc ps-5 print:hidden lg:sticky lg:top-10">
            
              <details
  open
  id="TOCView"
  class="toc-right mt-0 overflow-y-auto overscroll-contain scrollbar-thin scrollbar-track-neutral-200 scrollbar-thumb-neutral-400 dark:scrollbar-track-neutral-800 dark:scrollbar-thumb-neutral-600 rounded-lg -ms-5 ps-5 pe-2 hidden lg:block">
  <summary
    class="block py-1 text-lg font-semibold cursor-pointer bg-neutral-100 text-neutral-800 -ms-5 ps-5 dark:bg-neutral-700 dark:text-neutral-100 lg:hidden">
    Table of Contents
  </summary>
  <div
    class="min-w-[220px] py-2 border-dotted border-s-1 -ms-5 ps-5 dark:border-neutral-600">
    <nav id="TableOfContents">
  <ul>
    <li><a href="#system-message-logging-syslog">System Message Logging (Syslog)</a></li>
  </ul>
</nav>
  </div>
</details>
<details class="toc-inside mt-0 overflow-hidden rounded-lg -ms-5 ps-5 lg:hidden">
  <summary
    class="py-1 text-lg font-semibold cursor-pointer bg-neutral-100 text-neutral-800 -ms-5 ps-5 dark:bg-neutral-700 dark:text-neutral-100 lg:hidden">
    Table of Contents
  </summary>
  <div
    class="py-2 border-dotted border-neutral-300 border-s-1 -ms-5 ps-5 dark:border-neutral-600">
    <nav id="TableOfContents">
  <ul>
    <li><a href="#system-message-logging-syslog">System Message Logging (Syslog)</a></li>
  </ul>
</nav>
  </div>
</details>


<script>
  (function () {
    'use strict'

    const SCROLL_OFFSET_RATIO = 0.33
    const TOC_SELECTOR = '#TableOfContents'
    const ANCHOR_SELECTOR = '.anchor'
    const TOC_LINK_SELECTOR = 'a[href^="#"]'
    const NESTED_LIST_SELECTOR = 'li ul'
    const ACTIVE_CLASS = 'active'
    let isJumpingToAnchor = false

    function getActiveAnchorId(anchors, offsetRatio) {
      const threshold = window.scrollY + window.innerHeight * offsetRatio
      const tocLinks = [...document.querySelectorAll('#TableOfContents a[href^="#"]')]
      const tocIds = new Set(tocLinks.map(link => link.getAttribute('href').substring(1)))

      if (isJumpingToAnchor) {
        for (let i = 0; i < anchors.length; i++) {
          const anchor = anchors[i]
          if (!tocIds.has(anchor.id)) continue
          const top = anchor.getBoundingClientRect().top + window.scrollY
          if (Math.abs(window.scrollY - top) < 100) {
            return anchor.id
          }
        }
      }

      for (let i = anchors.length - 1; i >= 0; i--) {
        const top = anchors[i].getBoundingClientRect().top + window.scrollY
        if (top <= threshold && tocIds.has(anchors[i].id)) {
          return anchors[i].id
        }
      }
      return anchors.find(anchor => tocIds.has(anchor.id))?.id || ''
    }

    function updateTOC({ toc, anchors, links, scrollOffset, collapseInactive }) {
      const activeId = getActiveAnchorId(anchors, scrollOffset)
      if (!activeId) return

      links.forEach(link => {
        const isActive = link.getAttribute('href') === `#${activeId}`
        link.classList.toggle(ACTIVE_CLASS, isActive)

        if (collapseInactive) {
          const ul = link.closest('li')?.querySelector('ul')
          if (ul) ul.style.display = isActive ? '' : 'none'
        }
      })

      if (collapseInactive) {
        const activeLink = toc.querySelector(`a[href="#${CSS.escape(activeId)}"]`)
        let el = activeLink
        while (el && el !== toc) {
          if (el.tagName === 'UL') el.style.display = ''
          if (el.tagName === 'LI') el.querySelector('ul')?.style.setProperty('display', '')
          el = el.parentElement
        }
      }
    }

    function initTOC() {
      const toc = document.querySelector(TOC_SELECTOR)
      if (!toc) return

      const collapseInactive = true
      const anchors = [...document.querySelectorAll(ANCHOR_SELECTOR)]
      const links = [...toc.querySelectorAll(TOC_LINK_SELECTOR)]

      if (collapseInactive) {
        toc.querySelectorAll(NESTED_LIST_SELECTOR).forEach(ul => ul.style.display = 'none')
      }

      links.forEach(link => {
        link.addEventListener('click', () => {
          isJumpingToAnchor = true
        })
      })

      const config = {
        toc,
        anchors,
        links,
        scrollOffset: SCROLL_OFFSET_RATIO,
        collapseInactive
      }

      window.addEventListener('scroll', () => updateTOC(config), { passive: true })
      window.addEventListener('hashchange', () => updateTOC(config), { passive: true })

      updateTOC(config)
    }

    document.readyState === 'loading'
      ? document.addEventListener('DOMContentLoaded', initTOC)
      : initTOC()
  })()
</script>


            
          </div>
        </div>
      


      <div class="min-w-0 min-h-0 max-w-fit">
        

        <div class="article-content max-w-prose mb-20">
          
<h1 class="relative group">8 DHCP Snooping and ARP Inspection
    <div id="8-dhcp-snooping-and-arp-inspection" class="anchor"></div>
    
    <span
        class="absolute top-0 w-6 transition-opacity opacity-0 -start-6 not-prose group-hover:opacity-100 select-none">
        <a class="text-primary-300 dark:text-neutral-700 !no-underline" href="#8-dhcp-snooping-and-arp-inspection" aria-label="Anchor">#</a>
    </span>
    
</h1>
<p>Friday, October 1, 2021 11:13 AM</p>
<ul>
<li>attacker replies with false dhcp information by naming itself as the default gatewayPc1 send all messages to another network to attacker, becoming a man-in-the-middle<br>
attack (pc2 could forward the messages to the actual default gateway</li>
<li>the legitimate DHCP also returns a DHCPOFFER message to host PC1, but most hosts use the<br>
first received DHCPOFFER, and the attacker will likely be first in this scenario.</li>
</ul>
<p>DHCP Snooping Logic</p>
<ul>
<li>stops attacks by making ports untrusted</li>
</ul>
<pre tabindex="0"><code>▪ client can tell the DHCP server it no longer needs the address, releasing it back to the DHCP server
</code></pre><ul>
<li>DHCP RELEASE</li>
</ul>
<pre tabindex="0"><code>▪ turn down the use of an IP address during the normal DORA flow on messages.
</code></pre><ul>
<li>DHCP DECLINE</li>
<li>DHCP clients also use the DHCP RELEASE and DHCP DECLINE messages.</li>
</ul>
<pre tabindex="0"><code>DHCP Snooping rules:
</code></pre><ul>
<li>
<ul>
<li>Examine all incoming DHCP messages.If normally sent by servers, discard the message.</li>
</ul>
</li>
<li>If normally sent by clients, filter as follows:
<ul>
<li>check for MAC address consistency between the Ethernet frame and the DHCP message.</li>
</ul>
</li>
<li>DISCOVER and REQUEST</li>
</ul>
<pre tabindex="0"><code>check the incoming interface plus IP address versus the DHCP Snooping binding
table.
</code></pre><pre tabindex="0"><code>RELEASE or DECLINE -
</code></pre><ul>
<li>FSnooping binding table.or messages not filtered that result in a DHCP lease, build a new entry to the DHCP</li>
</ul>
<p>DHCP snooping checking MAC Address</p>
<ul>
<li>
<p>Source MAC address included in DISCOVER message</p>
</li>
<li>
<p>frame encapsulating the dhcp message also includes the source mac address</p>
<ul>
<li>if not the packet is dropped</li>
</ul>
</li>
<li>
<p>DHCP Snooping checks to make sure those values match.</p>
</li>
<li>
<p>Used on untrusted ports</p>
</li>
<li>
<p>chaddr (client hardware address)</p>
</li>
<li>
<p>stops attacker from leasing all available addresses so no other client can get a lease<br>
Filtering Messages that Release IP Addresses</p>
</li>
<li>
<p>creates entry for all legitimate DHCP entriesDHCP Snooping, and other features like Dynamic ARP Inspection, can use the table to make<br>
decisions.</p>
</li>
<li>
<ul>
<li>MACIP</li>
</ul>
</li>
<li>
<p>VLAN</p>
</li>
<li>
<p>DHCP Snooping Binding Table:</p>
</li>
<li>
<p>DHCP Snooping binding table</p>
</li>
<li>
<ul>
<li>VLANINTERFACE</li>
</ul>
</li>
<li>
<p>attacker pretends his source IP is the legitimate IP trying to RELEASE</p>
</li>
<li>
<p>the source interface in the DHCP Snooping Binding Table does not match so dhcp snooping bloacks the request</p>
</li>
<li>
<p>attacker could RELEASE an address that is not his and attempt steal it for himself</p>
</li>
</ul>
<pre tabindex="0"><code>checks client-sent messages like RELEASE and DECLINE that would cause the DHCP server to be
allowed to release an address
</code></pre><p>DHCP Snooping Configuration</p>
<ul>
<li><strong>ip dhcp snooping</strong></li>
<li>enable DHCP Snooping</li>
<li><strong>ip dhcp snooping vlan</strong> <em>vlan-id</em></li>
<li>list the VLANs on which to use DHCP Snooping</li>
</ul>
<pre tabindex="0"><code>Required:
</code></pre><ul>
<li>default is untrusted.</li>
<li><strong>(config-if) # ip dhcp snooping trust</strong></li>
</ul>
<pre tabindex="0"><code>Often used:- configure trusted ports
</code></pre><p>DHCP Snooping verification<br>
<strong>show ip dhcp snooping</strong></p>
<ul>
<li>enabled or disabled</li>
<li>
<ul>
<li>
<p>operational in which vlanstrusted interfaces
- (enabled by default)<br>
<strong>no ip dhcp information option</strong> - (because this switch is not a dhcp relay agent)command is configured</p>
<pre><code>- DHCP relay agents add option 82 DHCP header fields (RFC 3046)
- - If enabled on a non relay agent then dhcp stops working for end usersThe switch sets fields in the DHCP messages as if it were a DHCP relay agent
- changes to those messages cause most DHCP servers (and most DHCP relay agents) to ignore the received DHCP messages.
</code></pre>
</li>
</ul>
</li>
<li>Insertion of option 82 is disabled</li>
<li>Rate limit on each interface</li>
</ul>
<pre tabindex="0"><code>Shows actual dhcp snooping binding table
</code></pre><pre tabindex="0"><code>Show ip dhcp snooping binding
</code></pre><p>DHCP Rate Limiting</p>
<ul>
<li>
<p>attacker generates large volumes of DHCP messages to overload the DHCP Snooping feature and the switch CPU itself</p>
<ul>
<li>optional feature that tracks the number of incoming DHCP messages.
<ul>
<li>port changes to an err-disabled state.</li>
</ul>
</li>
<li>If the number of incoming DHCP messages exceeds that limit over a one-second period:
<ul>
<li>can be on both on trusted and untrusted interfaces.</li>
</ul>
</li>
<li>Default of no rate limit</li>
</ul>
</li>
<li>
<p>Default of no rate limit</p>
</li>
</ul>
<pre tabindex="0"><code>(config-int) # ip dhcp snooping rate limit number
errdisable recovery cause dhcp - recover from errdisable if caused by dhcp snooping - rate-limit
errdisable recovery interval - seconds to wait before recovering number
(config-int) # no ip dhcp snooping rate limit
</code></pre><pre tabindex="0"><code>how to enable DHCP Snooping rate limits and err-disabled recovery.
</code></pre><p>Dynamic ARP Inspection (DAI)<br>
examines incoming ARP messages on untrusted ports to filter those it believes to be part of an<br>
attack.</p>
<ul>
<li>
<ul>
<li>
<ul>
<li>DHCP Snooping binding tableconfigured ARP ACLs.</li>
</ul>
</li>
</ul>
</li>
<li>compares incoming ARP messages with two sources of data:</li>
<li>If the incoming ARP message does not match the tables in the switch, the switch discards the ARP message.</li>
</ul>
<p>DAI Concepts<br>
gratuitous ARP (arp reply)triggers hosts to add incorrect ARP entries to their ARP tables.—</p>
<pre tabindex="0"><code>Both hosts learn the other host’s MAC address with this twolearn R2’s MAC address based on the ARP reply (message 2), but router R2 learns PC1’s IP and -message flow. Not only does PC
MAC address because of the ARP request (message 1).
</code></pre><ul>
<li>source mac</li>
<li>destination mac (broadcast)</li>
<li>Ethernet Frame</li>
<li>
<ul>
<li>Origin IPTarget IP</li>
</ul>
</li>
<li>
<ul>
<li>Origin MACTarget MAC ??</li>
</ul>
</li>
<li>ARP</li>
</ul>
<pre tabindex="0"><code>ARP Request
</code></pre><ul>
<li>
<ul>
<li>Source MACDest. MAC</li>
</ul>
</li>
<li>Ethernet Frame</li>
<li>
<ul>
<li>Origin IPTarget IP</li>
</ul>
</li>
<li>
<ul>
<li>Origin MACTarget MAC</li>
</ul>
</li>
<li>ARP</li>
</ul>
<pre tabindex="0"><code>ARP Reply
</code></pre><p>Review of Normal IP ARP</p>
<p>Gratuitous ARP as an Attack Vector</p>
<ul>
<li>when a host changes its MAC address it can send a gratuitous ARP message with these features:
<ul>
<li>ARP reply.</li>
<li>sent without having first received an ARP request.sent to an Ethernet destination broadcast address so that all hosts in the subnet receive the</li>
<li>message.</li>
<li>attacker uses gratuitous arp to make replies go back to it instead of original host</li>
</ul>
</li>
<li>could be part of a man-in-the-middle attack</li>
</ul>
<p>Dynamic ARP Inspection Logic</p>
<ul>
<li>
<p>Host does not need arp if it doesn&rsquo;t have an IP yet</p>
</li>
<li>
<p>Once DHCP assigns and IP then ARP is usedfor untrusted interfaces DAI confirms an ARP’s correctness based on the DHCP Snooping Binding<br>
table</p>
</li>
<li>
<p>compares origin MAC and IP</p>
</li>
<li>
<ul>
<li>if not found on the table, discard the arpsame trusted and untrusted rules as dhcp snooping
- statically configured
- list correct pairs of IP and mac addressesUseful for ip addresses configured statically because they will not be in the dhcp snooping<br>
binding table</li>
</ul>
</li>
</ul>
<pre tabindex="0"><code>ARP ACL
</code></pre><pre tabindex="0"><code>DAI can check Ethernet header and arp source and destination messages mac addresses to make
sure they match
</code></pre><ul>
<li>
<p>DAI can also check Messages with unexpected IP addresses in the two ARP IP address fields</p>
<ul>
<li>DAI itself can be more susceptible to DoS attacks.</li>
<li>attacker could generate large numbers of ARP messages, driving up CPU usage in the switch.<br>
DAI can avoid these problems through rate limiting the number of ARP messages on a port<br>
over time.</li>
</ul>
</li>
<li>
<p>does its work in the switch CPU rather than in the switch ASIC</p>
</li>
</ul>
<p>Configuring ARP Inspection on a Layer 2 Switch<br>
decisions include the following:</p>
<ul>
<li>Choose whether to rely on DHCP Snooping, ARP ACLs, or both.</li>
<li>
<ul>
<li>If using DHCP Snooping, configure it and make the correct ports trusted for DHCP Snooping.Choose the VLAN(s) on which to enable DAI.</li>
</ul>
</li>
<li>Make DAI trusted (rather than theVLANs, typically for the same ports you trusted for DHCP Snooping.default setting of untrusted) on select ports in those<br>
<strong>ip arp inspection vlan</strong> - enable arp DAI on that vlan <em>vlan-id</em><br>
<strong>(config</strong> - dhcp snooping should be enabled or DAI will filter all packets <strong>- if)# ip arp inspection trust<br>
ip dhcp snoopingip dhcp snooping vlan</strong> <em>vlan-id</em><br>
<strong>ip dhcp snooping trust</strong></li>
</ul>
<pre tabindex="0"><code>ip dhcp snooping trust (configure arp ACLs)
</code></pre><pre tabindex="0"><code>gives both -- forwarded, dropped, dhcp drops, acl drop countsIs logging enabled?configuration settings along with status variables and counters
</code></pre><pre tabindex="0"><code>show ip arp inspection -
</code></pre><ul>
<li>counts per vlan- forwarded, dropped, dhcp drops, acl drops</li>
<li>permits</li>
</ul>
<pre tabindex="0"><code>show ip arp inspection statistics
</code></pre><p>ARP Rate Limiting</p>
<ul>
<li>(trusted and untrusted)</li>
<li>Default for all interfaces</li>
<li>
<ul>
<li>x ARP messages over y seconds”(DHCP Snooping does not define a burst setting)</li>
</ul>
</li>
<li>optional configuration</li>
<li>8 messages in a burst of 4 seconds</li>
</ul>
<pre tabindex="0"><code>ip arp inspection limit rate 8 burst interval 4
</code></pre><ul>
<li>default of 15 messages over a one second burst<br>
<strong>show ip arp inspection interfaces</strong> - rate, burst interval, trust state, per interface</li>
</ul>
<pre tabindex="0"><code>burst interval (a number of seconds)
</code></pre><pre tabindex="0"><code>ip arp inspection limit rate number
</code></pre><ul>
<li>disable rate limiting</li>
</ul>
<pre tabindex="0"><code>ip arp inspection limit rate none
</code></pre><p><strong>errdisable recovery cause arperrdisable recovery interval</strong> <em>30</em> <strong>- inspection</strong></p>
<p>Configuring Optional DAI Message Checks</p>
<ul>
<li>one, two, or all three of the options</li>
<li>
<ul>
<li>command with overrides previous versions of the same command <strong>show ip arp inspection</strong> to validate</li>
</ul>
</li>
</ul>
<pre tabindex="0"><code>ip arp inspection validate {dst-mac, ip, src-mac}
</code></pre><pre tabindex="0"><code>drop ARP packets the body of the ARP packets do not match the addresses specified in the Ethernet header.when the IP addresses in the packets are invalid or when the MAC addresses in
Forin the ARP body. This check is src-mac, check the source MAC address in the Ethernet header against the sender MAC address performed on both ARP requests and responses. When enabled,
packets with different MAC addresses are classified as invalid and are dropped.
</code></pre><ul>
<li>Foraddress in ARP body. This check isdst-mac, check the destination MAC address in the Ethernet header against the target MAC performed for ARP responses.When enabled, packets with<br>
different MAC addresses are classified as invalid and are dropped.</li>
<li>For255.255.255.255, and all IP multicast addresses. ip, check the ARP body for invalid and unexpected IP addresses. Addresses include 0.0.0.0, Sender IP addresses are checked in all ARP<br>
requests and responses, and target IP addresses are checked only in ARP responses</li>
</ul>
<pre tabindex="0"><code>2.0 Network Access
2.3 Configure and verify Layer 2 discovery protocols (Cisco Discovery Protocol and LLDP)
4.0 IP Services
4.2 Configure and verify NTP operating in a client and server mode
4.5 Describe the use of syslog features including facilities and levels
</code></pre>
<h2 class="relative group">System Message Logging (Syslog)
    <div id="system-message-logging-syslog" class="anchor"></div>
    
    <span
        class="absolute top-0 w-6 transition-opacity opacity-0 -start-6 not-prose group-hover:opacity-100 select-none">
        <a class="text-primary-300 dark:text-neutral-700 !no-underline" href="#system-message-logging-syslog" aria-label="Anchor">#</a>
    </span>
    
</h2>
<pre tabindex="0"><code>Sending Messages in Real Time to Current Users
</code></pre><ul>
<li>Telnet and SSH users, the device requires a two-step process before the user sees the messages.<br>
global configuration setting—logging monitor—tells IOS to enable the sending of log<br>
messages to all logged users.</li>
</ul>
<p>must also issue theterminal monitorEXEC command during the login session, which tells<br>
IOS that this terminal session would like to receive log messages.</p>
<pre tabindex="0"><code>Storing Log Messages for Later Review
two primary means to keep a copy
</code></pre><ul>
<li>can configuration command.store copies of the log messages in RAMby virtue of the <strong>logging buffered</strong> global<br>
any user can come back later and see the old log messagesby using the <strong>show</strong><br>
<strong>logging EXEC command.</strong><br>
store log messages centrally to a syslog server.<br>
syslog protocol - a UDP protocol to send messages to a syslog server for storage<br>
To configure a router or switch to send log messages to a syslog server, add the</li>
</ul>

          
          
          
        </div>
        
        

        

        

      </div>

      
      
        
        
          
          
        
        
        
        <script
          type="text/javascript"
          src="/js/page.min.54b6f4371722649edbe871e431d8670d670878c22be8f36e229fe53cc9b786fe25a834def5e6de621f7a3e37b72bc8cd73839aa5ed907ed6cbd45cd3e1b0fa20.js"
          integrity="sha512-VLb0NxciZJ7b6HHkMdhnDWcIeMIr6PNuIp/lPMm3hv4lqDTe9ebeYh96Pje3K8jNc4Oape2QftbL1FzT4bD6IA=="
          data-oid="views_tech/networking/newccnanotes/8 DHCP Snooping and ARP Inspection.md"
          data-oid-likes="likes_tech/networking/newccnanotes/8 DHCP Snooping and ARP Inspection.md"></script>
      
    </section>

    
    <footer class="pt-8 max-w-prose print:hidden">
      

      
    </footer>
  </article>

        


  






<div
  id="scroll-to-top"
  class="fixed bottom-6 end-6 z-50 transform translate-y-4 opacity-0 duration-200">
  <a
    href="#the-top"
    class="pointer-events-auto flex h-12 w-12 items-center justify-center rounded-full bg-neutral/50 text-xl text-neutral-700 hover:text-primary-600 dark:bg-neutral-800/50 dark:text-neutral dark:hover:text-primary-400"
    aria-label="Scroll to top"
    title="Scroll to top">
    &uarr;
  </a>
</div>

      </main><footer id="site-footer" class="py-10 print:hidden">
  
  
    
      
      
        
      
      
      
      
      <nav class="flex flex-row pb-4 text-base font-medium text-neutral-500 dark:text-neutral-400 overflow-x-auto py-2">
        <ul class="flex list-none flex-row">
          
            <li class=" flex mb-1 text-end sm:mb-0 sm:me-7 sm:last:me-0 me-4">
              <a
                class="decoration-primary-500 hover:underline hover:decoration-2 hover:underline-offset-2 flex items-center"
                href=""
                title="">
                
                
              </a>
            </li>
          
        </ul>
      </nav>
    
  
  <div class="flex items-center justify-between">
    
    
      <p class="text-sm text-neutral-500 dark:text-neutral-400">
          &copy;
          2025
          David Thomas
      </p>
    

    
    
  </div>
  
    <script>
      mediumZoom(document.querySelectorAll("img:not(.nozoom)"), {
        margin: 24,
        background: "rgba(0,0,0,0.5)",
        scrollOffset: 0,
      });
    </script>
  
  
  
  <script
    type="text/javascript"
    src="/js/process.min.ee03488f19c93c2efb199e2e3014ea5f3cb2ce7d45154adb3399a158cac27ca52831db249ede5bb602700ef87eb02434139de0858af1818ab0fb4182472204a4.js"
    integrity="sha512-7gNIjxnJPC77GZ4uMBTqXzyyzn1FFUrbM5mhWMrCfKUoMdsknt5btgJwDvh&#43;sCQ0E53ghYrxgYqw&#43;0GCRyIEpA=="></script>
  
  
</footer>
<div
  id="search-wrapper"
  class="invisible fixed inset-0 flex h-screen w-screen cursor-default flex-col bg-neutral-500/50 p-4 backdrop-blur-sm dark:bg-neutral-900/50 sm:p-6 md:p-[10vh] lg:p-[12vh] z-500"
  data-url="http://localhost:1313/">
  <div
    id="search-modal"
    class="flex flex-col w-full max-w-3xl min-h-0 mx-auto border rounded-md shadow-lg top-20 border-neutral-200 bg-neutral dark:border-neutral-700 dark:bg-neutral-800">
    <header class="relative z-10 flex items-center justify-between flex-none px-2">
      <form class="flex items-center flex-auto min-w-0">
        <div class="flex items-center justify-center w-8 h-8 text-neutral-400">
          <span class="relative block icon"><svg aria-hidden="true" focusable="false" data-prefix="fas" data-icon="search" class="svg-inline--fa fa-search fa-w-16" role="img" xmlns="http://www.w3.org/2000/svg" viewBox="0 0 512 512"><path fill="currentColor" d="M505 442.7L405.3 343c-4.5-4.5-10.6-7-17-7H372c27.6-35.3 44-79.7 44-128C416 93.1 322.9 0 208 0S0 93.1 0 208s93.1 208 208 208c48.3 0 92.7-16.4 128-44v16.3c0 6.4 2.5 12.5 7 17l99.7 99.7c9.4 9.4 24.6 9.4 33.9 0l28.3-28.3c9.4-9.4 9.4-24.6.1-34zM208 336c-70.7 0-128-57.2-128-128 0-70.7 57.2-128 128-128 70.7 0 128 57.2 128 128 0 70.7-57.2 128-128 128z"/></svg>
</span>
        </div>
        <input
          type="search"
          id="search-query"
          class="flex flex-auto h-12 mx-1 bg-transparent appearance-none focus:outline-dotted focus:outline-2 focus:outline-transparent"
          placeholder="Search"
          tabindex="0">
      </form>
      <button
        id="close-search-button"
        class="flex items-center justify-center w-8 h-8 text-neutral-700 hover:text-primary-600 dark:text-neutral dark:hover:text-primary-400"
        title="Close (Esc)">
        <span class="relative block icon"><svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 320 512"><path fill="currentColor" d="M310.6 361.4c12.5 12.5 12.5 32.75 0 45.25C304.4 412.9 296.2 416 288 416s-16.38-3.125-22.62-9.375L160 301.3L54.63 406.6C48.38 412.9 40.19 416 32 416S15.63 412.9 9.375 406.6c-12.5-12.5-12.5-32.75 0-45.25l105.4-105.4L9.375 150.6c-12.5-12.5-12.5-32.75 0-45.25s32.75-12.5 45.25 0L160 210.8l105.4-105.4c12.5-12.5 32.75-12.5 45.25 0s12.5 32.75 0 45.25l-105.4 105.4L310.6 361.4z"/></svg>
</span>
      </button>
    </header>
    <section class="flex-auto px-2 overflow-auto">
      <ul id="search-results">
        
      </ul>
    </section>
  </div>
</div>

    </div>
  </body>
  
</html>
